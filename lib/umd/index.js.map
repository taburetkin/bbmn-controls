{"version":3,"file":"index.js","sources":["button/mixin.js","button/index.js","control-mixin/index.js","control-view/mixin.js","promise-bar/mixin.js","promise-bar/index.js","control-view/index.js","edit-schema/common.js","edit-schema/property.js","edit-schema/model.js","input/get-input-type.js","input/set-attributes.js","input/events/_get-option.js","input/events/_is-char.js","input/events/keydown.js","input/events/keyup.js","input/events/paste.js","input/events/blur.js","input/events/focus.js","input/events/input.js","input/events/index.js","input/handle-event.js","input/set-events.js","input/mixin.js","input/index.js","textarea/index.js","edit-schema/get-control-by-string.js","edit-schema/build-control.js","edit-schema/index.js"],"sourcesContent":["import _ from 'underscore';\r\nimport { View } from 'backbone.marionette';\r\n\r\nexport default Base => {\r\n\tif (Base == null) {\r\n\t\tBase = View;\r\n\t}\r\n\tBase.extend({\r\n\r\n\t\ttriggerNameEvent: true,\r\n\t\tstopEvent: true,\r\n\r\n\t\tconstructor(options){\r\n\t\t\tBase.apply(this, arguments);\r\n\t\t\tthis.mergeOptions(options, ['name']);\r\n\t\t},\r\n\t\ttagName:'button',\r\n\t\ttemplate: _.template('<i></i><span><%= text %></span><i></i>'),\r\n\t\tevents:{\r\n\t\t\t'click'(e) {\r\n\t\t\t\tlet stop = this.getOption('stopEvent');\r\n\t\t\t\tif (stop) {\r\n\t\t\t\t\te.stopPropagation();\r\n\t\t\t\t\te.preventDefault();\r\n\t\t\t\t}\r\n\t\t\t\tthis.beforeClick().then(\r\n\t\t\t\t\tdata => {\r\n\t\t\t\t\t\tthis.triggerMethod('click', data, e, this);\r\n\t\t\t\t\t\tif (this.name) {\r\n\t\t\t\t\t\t\tthis.triggerMethod('click:'+this.name, data, e, this);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\terror => {\r\n\t\t\t\t\t\tthis.triggerMethod('click:fail', error, this.name, e, this);\r\n\t\t\t\t\t\tif (this.name) {\r\n\t\t\t\t\t\t\tthis.triggerMethod('click:'+this.name+':fail', error, e, this);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t},\r\n\t\tbeforeClick(){\r\n\t\t\tlet result = this.triggerMethod('before:click');\r\n\t\t\tif(result && _.isFunction(result.then) ) {\r\n\t\t\t\treturn result;\r\n\t\t\t} else {\r\n\t\t\t\treturn Promise.resolve(result);\r\n\t\t\t}\r\n\t\t},\r\n\t\ttemplateContext(){\r\n\t\t\treturn {\r\n\t\t\t\ttext: this.getOption('text')\r\n\t\t\t};\r\n\t\t},\r\n\t\tdisable(){\r\n\t\t\tthis.$el.prop('disabled', true);\r\n\t\t},\r\n\t\tenable(){\r\n\t\t\tthis.$el.prop('disabled', false);\r\n\t\t},\r\n\t});\r\n};\r\n","import { View } from '../config';\r\nimport buttonMixin from './mixin';\r\nexport {\r\n\tbuttonMixin\r\n};\r\nexport default buttonMixin(View);\r\n","\r\nimport _ from 'underscore';\r\nimport { flat, unflat, setByPath, getByPath, compareObjects, betterResult, takeValue } from 'bbmn-utils';\r\n\r\nfunction getTriggerMethod(context){\r\n\tif(!context) { return () => {}; }\r\n\treturn _.isFunction(context.triggerMethod) ? context.triggerMethod\r\n\t\t: _.isFunction(context.trigger) ? context.trigger\r\n\t\t\t: () => {};\r\n}\r\n\r\nfunction ensureError(error, value){\r\n\tif(error instanceof Error){\r\n\t\tthrow error;\r\n\t}\r\n\treturn arguments.length > 1 ? value : error;\r\n}\r\n\r\n\r\nexport default Base => Base.extend({\r\n\r\n\tisControl: true,\r\n\tvalidateOnReady: false,\r\n\r\n\tconstructor(options){\t\t\r\n\t\tthis._initControl(options);\r\n\t\tBase.apply(this, arguments);\r\n\t\tif (this.getOption('validateOnReady')) {\r\n\t\t\tthis.once('control:ready', () => {\r\n\t\t\t\tthis.validate().catch(() => {});\r\n\t\t\t});\r\n\t\t}\r\n\t},\r\n\r\n\r\n\r\n\t_onControlDestroy(){\r\n\t\tlet parent = this.getParentControl();\r\n\t\tif (parent && _.isFunction(parent._removeChildControl)) {\r\n\t\t\tparent._removeChildControl(this);\r\n\t\t}\r\n\t\tlet children = this.getChildrenControls();\r\n\t\tif (children) {\r\n\t\t\t_.each(children, child => child._removeParentControl());\r\n\t\t\tchildren.length = 0;\r\n\t\t}\r\n\t\tdelete this._cntrl;\r\n\t},\r\n\t_removeChildControl(control){\r\n\t\tthis.off(control);\r\n\t\tlet children = this.getChildrenControls();\r\n\t\tif (!children.length) { return; }\r\n\t\tlet index = children.indexOf(control);\r\n\t\tif (index === -1) return;\r\n\t\tchildren.splice(index, 1);\r\n\t},\r\n\t_addChildControl(control){\r\n\t\tlet controlName = control.getControlName();\r\n\t\tlet children = this.getChildrenControls();\r\n\t\tlet found = _.find(children, child => child.getControlName() === controlName);\r\n\t\t!found && children.push(control);\r\n\t},\r\n\t_removeParentControl(){\r\n\t\tdelete this._cntrl.parent;\r\n\t},\r\n\r\n\r\n\r\n\t_initControl(options = {}){\r\n\t\tif (this._controlInitialized) { return; }\r\n\r\n\t\tthis._cntrl = {};\r\n\t\tlet name = takeValue('controlName', options, this) || 'control';\r\n\t\tthis._cntrl.name = name;\r\n\r\n\t\tlet value = takeValue('value', options, this);\r\n\t\tvalue = this._clone(value);\r\n\t\tthis.initControlValue(value);\r\n\t\tthis.initParentControl(options);\r\n\r\n\t\tthis.once('destroy', this._onControlDestroy);\r\n\r\n\t\tthis._controlInitialized = true;\r\n\t},\r\n\tinitParentControl(options){\r\n\t\tlet parent = takeValue('proxyTo', options, this) || takeValue('parentControl', options, this);\r\n\t\tthis.setParentControl(parent);\r\n\t},\r\n\tsetParentControl(parent){\r\n\t\tthis._cntrl.parent = parent;\r\n\t\tif (parent && _.isFunction(parent._addChildControl)) {\r\n\t\t\tparent._addChildControl(this);\r\n\t\t}\r\n\t},\r\n\tinitControlValue(value){\r\n\t\tthis._cntrl.initial = value;\r\n\t\tthis._cntrl.value = value;\r\n\t},\r\n\tgetControlName(){\r\n\t\treturn this._cntrl.name;\r\n\t},\r\n\r\n\tisSameControlValue(value){\r\n\t\tlet current = this.getControlValue();\r\n\t\treturn this.isValid() && compareObjects(current, value);\r\n\t},\r\n\r\n\tgetControlValue(key, options = {}){\r\n\t\t\r\n\t\tif(_.isObject(key)) {\r\n\t\t\toptions = key;\r\n\t\t\tkey = undefined;\r\n\t\t}\r\n\t\tlet { notValidated, clone } = options;\r\n\t\tlet valueKey = notValidated ? 'notValidated' : 'value';\r\n\t\tlet value = this._cntrl[valueKey];\r\n\t\tif (key != null) {\r\n\t\t\treturn getByPath(value, key);\r\n\t\t} else {\r\n\t\t\treturn clone ? this._clone(value) : value;\r\n\t\t}\r\n\t},\r\n\r\n\tsetControlValue(value, options = {}){\r\n\t\tlet  { key, notValidated } = options;\r\n\t\tvalue = this._prepareValueBeforeSet(value, { key });\r\n\t\tconst resolve = Promise.resolve(value);\r\n\t\tif (this.isSameControlValue(value)) { return resolve; }\r\n\r\n\t\tthis._cntrl.notValidated = value;\r\n\r\n\t\tif (notValidated) { return resolve; }\r\n\t\treturn this._setControlValue(value, options);\r\n\t},\r\n\r\n\t_prepareValueBeforeSet(value, { key } = {}){\r\n\t\tvalue = this.prepareValueBeforeSet(value);\r\n\t\tif (key == null) { return value; }\r\n\r\n\t\tlet current = this.getControlValue({ notValidated: true, clone: true }) || {};\r\n\t\tsetByPath(current, key, value);\r\n\t\treturn current;\r\n\t},\r\n\r\n\t//override this if you need to modify value before set\r\n\tprepareValueBeforeSet: value => value,\r\n\r\n\t_setControlValue(value, options = {}) {\r\n\t\tlet { skipValidation } = options;\r\n\t\tif (skipValidation) {\r\n\t\t\treturn this._onSetControlValueValidateSuccess(value, options);\r\n\t\t}\r\n\t\treturn this._validate(value, options)\r\n\t\t\t.then(\r\n\t\t\t\t() => this._onSetControlValueValidateSuccess(value, options), \r\n\t\t\t\terror => this._onSetControlValueValidateFail(error, value, options)\r\n\t\t\t);\r\n\t},\r\n\t_onSetControlValueValidateSuccess(value, options){\r\n\t\tthis._cntrl.previous = this._cntrl.value;\r\n\t\tthis._cntrl.value = value;\r\n\t\tthis._cntrl.isDone = false;\r\n\t\tthis._tryTriggerEvent('change', [value], options);\r\n\t\treturn Promise.resolve(value);\r\n\t},\r\n\r\n\t_onSetControlValueValidateFail(error, value, options){\r\n\t\tthis._tryTriggerEvent('change:fail', [value, error], options);\r\n\t\treturn ensureError(error, value);\r\n\t},\r\n\r\n\tisValid(){\r\n\t\treturn this._cntrl.isValid !== false;\r\n\t},\r\n\r\n\tvalidate(options = {}){\r\n\r\n\t\tlet notValidated = !this.isValid();\r\n\t\tlet value = this.getControlValue({ notValidated });\r\n\t\tlet promise = this._validate(value, options);\r\n\t\tlet _catch = options.catch;\r\n\r\n\t\tif (_catch === false) {\r\n\t\t\treturn promise;\r\n\t\t} else if(_.isFunction(_catch)) {\r\n\t\t\treturn promise.catch(_catch);\r\n\t\t} else {\r\n\t\t\treturn promise.catch(ensureError);\r\n\t\t}\r\n\t},\r\n\t_validate(value, options){\r\n\r\n\t\tlet validate = this._validatePromise(value, options);\r\n\r\n\t\treturn validate.then(\r\n\t\t\t() => this._onControlValidateSuccess(value, options),\r\n\t\t\terror => this._onControlValidateFail(error, value, options)\r\n\t\t);\r\n\t},\r\n\t_validatePromise(value, options){\r\n\t\t\r\n\t\tconst { skipChildValidate } = options;\r\n\t\tconst isControlWrapper = betterResult(this, 'isControlWrapper', { args:[this]});\r\n\r\n\t\t\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\tlet childrenErrors = {\r\n\t\t\t\tchildren: {}\r\n\t\t\t};\r\n\t\t\tlet childrenPromise = this._validateChildrenControlsPromise({ skipChildValidate, isControlWrapper }, childrenErrors);\r\n\r\n\t\t\tchildrenPromise.then(() => {\r\n\r\n\t\t\t\tif (_.size(childrenErrors.children)) {\r\n\t\t\t\t\treject(childrenErrors.children);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t} else if (childrenErrors.wrapped) {\r\n\t\t\t\t\treject(childrenErrors.wrapped);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\r\n\t\t\t\tlet promise = this._validateControlPromise(value, options);\r\n\r\n\t\t\t\tpromise.then(\r\n\t\t\t\t\t() => {\r\n\t\t\t\t\t\tresolve(value);\r\n\t\t\t\t\t},\r\n\t\t\t\t\terror => {\r\n\t\t\t\t\t\treject(error);\r\n\t\t\t\t\t}\r\n\t\t\t\t);\r\n\r\n\t\t\t});\r\n\t\t});\t\t\r\n\t},\r\n\t_validateControlPromise(value, options){\r\n\t\tlet validate = this.getOption('controlValidate', { force: false });\r\n\t\t\t\t\r\n\t\t//if there is no validation defined, resolve\r\n\t\tif (!_.isFunction(validate)) {\r\n\t\t\t\r\n\t\t\treturn Promise.resolve(value);\r\n\t\t}\r\n\r\n\t\tlet values = this.getParentControlValue({ notValidated: true });\r\n\t\tlet validateResult = validate.call(this, value, values, options);\r\n\r\n\t\tlet promise = Promise.resolve(value);\r\n\t\tif (validateResult && validateResult.then) {\r\n\t\t\tpromise = validateResult;\r\n\t\t} else if (validateResult) {\r\n\t\t\tpromise = Promise.reject(validateResult);\r\n\t\t}\r\n\t\treturn promise;\r\n\t},\r\n\t_validateChildrenControlsPromise({ isControlWrapper, skipChildValidate} = {}, errors = {}){\r\n\r\n\t\tlet children = this.getChildrenControls();\r\n\t\tlet childrenPromise = Promise.resolve();\r\n\t\tif (!children.length) return childrenPromise;\r\n\r\n\t\treturn _.reduce(children, (finaly, child) => {\r\n\t\t\tlet control = child.getControlName();\r\n\r\n\t\t\tfinaly = finaly.then(() => {\r\n\r\n\t\t\t\tif (!child.validate || (skipChildValidate && control == skipChildValidate)) {\r\n\t\t\t\t\treturn Promise.resolve();\r\n\t\t\t\t}\r\n\t\t\t\tlet validateResult = child.validate({ stopPropagation: true, catch: false });\r\n\r\n\t\t\t\treturn validateResult;\r\n\t\t\t}).catch(error => {\r\n\r\n\t\t\t\tif(isControlWrapper){\r\n\t\t\t\t\terrors.wrapped = error;\r\n\t\t\t\t} else {\r\n\t\t\t\t\terrors.children[control] = error;\r\n\t\t\t\t}\r\n\t\t\t\treturn Promise.resolve();\r\n\t\t\t});\r\n\t\t\treturn finaly;\r\n\t\t}, childrenPromise);\t\t\r\n\r\n\t},\r\n\r\n\t_onControlValidateSuccess(value, options){\r\n\t\tthis.makeValid(value, options);\r\n\t\treturn Promise.resolve(value);\r\n\t},\r\n\tmakeValid(value, options){\r\n\t\tthis._cntrl.isValid = true;\r\n\t\tif(!this.isSameControlValue(value)){\r\n\t\t\tthis._setControlValue(value, { silent: true, skipValidation: true });\r\n\t\t}\r\n\t\tthis._tryTriggerEvent('valid', [value], options);\r\n\t},\r\n\t_onControlValidateFail(error, value, options){\r\n\t\tthis.makeInvalid(error, value, options);\r\n\t\treturn Promise.reject(error);\r\n\t},\r\n\tmakeInvalid(error, value, options){\r\n\t\tthis._cntrl.isValid = false;\r\n\t\tthis._tryTriggerEvent('invalid', [value, error], options);\r\n\t},\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\tgetParentControl() {\r\n\t\treturn this._cntrl.parent;\r\n\t},\r\n\tgetParentControlValue(options) {\r\n\r\n\t\tlet parent = this.getParentControl();\r\n\t\tif (!parent || !_.isFunction(parent.getControlValue)) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (betterResult(parent, 'isControlWrapper', { args:[this]})) {\r\n\t\t\treturn parent.getParentControlValue(options);\r\n\t\t} else {\r\n\t\t\treturn parent.getControlValue(options);\r\n\t\t}\r\n\t},\r\n\r\n\tgetChildrenControls(){\r\n\t\tif(!this._cntrl.children) {\r\n\t\t\tthis._cntrl.children = [];\r\n\t\t}\r\n\t\treturn this._cntrl.children;\r\n\t},\r\n\thandleChildControlEvent(event, controlName, ...args) {\r\n\t\tlet childEvent = controlName + ':' + event;\r\n\t\tlet trigger = getTriggerMethod(this);\r\n\t\ttrigger.call(this, childEvent, ...args);\r\n\r\n\t\tlet cce = this.getOption('childControlEvents', { args: [this] }) || {};\r\n\t\tlet def = this.defaultChildControlEvents || {};\r\n\t\tif(!this._debouncedChildControlEvents) {\r\n\t\t\tthis._debouncedChildControlEvents = {};\r\n\t\t}\r\n\t\tlet dcce = this._debouncedChildControlEvents;\r\n\r\n\t\tlet defHandler = def[event];\r\n\t\tlet handler = cce[childEvent];\r\n\t\tlet handlerArguments = [];\r\n\t\tlet handlerName;\r\n\t\tif (_.isFunction(handler)) {\r\n\t\t\thandlerArguments = args;\r\n\t\t\thandlerName = childEvent;\r\n\t\t\t//handler.apply(this, args);\r\n\t\t} else if(_.isFunction(defHandler)){\r\n\t\t\thandlerName = '_default:' + event;\r\n\t\t\thandler = defHandler;\r\n\t\t\thandlerArguments = [controlName, ...args];\r\n\t\t} else {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\tlet delay = this.getOption('debounceChildControlEvents');\r\n\t\tif(_.isNumber(delay) && delay > 0){\r\n\t\t\tif(!dcce[handlerName]){\r\n\t\t\t\tdcce[handlerName] = _.debounce(handler, delay);\r\n\t\t\t}\r\n\t\t\thandler = dcce[handlerName];\r\n\t\t}\r\n\r\n\t\thandler.apply(this, handlerArguments);\r\n\r\n\t},\r\n\t\r\n\tdefaultChildControlEvents:{\r\n\t\t'change'(controlName, value){\r\n\t\t\tlet isControlWraper = this.getOption('isControlWrapper');\r\n\t\t\tisControlWraper && (controlName = undefined);\r\n\t\t\tthis.setControlValue(value, { key: controlName, skipChildValidate: controlName });\r\n\t\t},\r\n\t\t'done'(controlName, value){\r\n\t\t\tlet isControlWraper = this.getOption('isControlWrapper');\r\n\t\t\tisControlWraper && (controlName = undefined);\r\n\t\t\tthis.setControlValue(value, { key: controlName, skipChildValidate: controlName });\r\n\t\t\tif(isControlWraper) {\r\n\t\t\t\tthis.controlDone();\r\n\t\t\t}\r\n\t\t},\r\n\t\t'invalid'(controlName, value, error){\r\n\t\t\tif(this.getOption('isControlWrapper')){\r\n\t\t\t\tcontrolName = undefined;\r\n\t\t\t}\r\n\t\t\tthis.setControlValue(value, { key: controlName, silent: true, notValidated: true });\r\n\t\t\tthis.makeInvalid(error, this.getControlValue({ notValidated: true }));\r\n\t\t},\r\n\t},\r\n\r\n\tcontrolDone(){\r\n\t\tif (!this._cntrl.isValid || this._cntrl.isDone) { return; }\r\n\t\tlet value = this.getControlValue();\r\n\t\tthis._cntrl.isDone = true;\r\n\t\tthis._tryTriggerEvent('done', [value]);\r\n\t},\r\n\r\n\r\n\t/*\r\n\t\thelpers\r\n\t*/\r\n\t_clone(value){\r\n\t\tif(_.isArray(value))\r\n\t\t\treturn value.slice(0);\r\n\t\telse if(_.isObject(value)) {\r\n\t\t\treturn unflat(flat(value));\r\n\t\t} else\r\n\t\t\treturn value;\r\n\t},\r\n\t_tryTriggerEvent(name, args = [], { silent, stopPropagation } = {}){\r\n\t\tif (silent) { return; }\r\n\t\tlet controlName = this.getControlName();\r\n\t\tlet event = 'control:' + name;\r\n\t\tlet namedEvent = controlName + ':' + name;\r\n\r\n\t\tlet trigger = getTriggerMethod(this);\r\n\t\t\r\n\t\ttrigger.call(this, event, ...args);\r\n\r\n\t\tlet parent = this.getParentControl();\r\n\t\tif (stopPropagation || !parent) { return; }\r\n\t\tif (_.isFunction(parent.handleChildControlEvent)) {\r\n\t\t\tparent.handleChildControlEvent(name, controlName, ...args);\r\n\t\t} else {\r\n\t\t\tlet parentTrigger = getTriggerMethod(parent);\r\n\t\t\tparentTrigger.call(parent, namedEvent, ...args);\r\n\t\t}\r\n\r\n\t},\r\n\tmakeControlReady(){\r\n\t\tlet trigger = getTriggerMethod(this);\r\n\t\ttrigger.call(this, 'control:ready');\r\n\t},\r\n\r\n}, { ControlMixin: true });\r\n","\r\n//import { isView, isViewClass } from '../../../vendors/helpers.js';\r\nimport _ from 'underscore';\r\nimport { cssClassModifiersMixin, customsMixin } from 'bbmn-mixins';\r\nimport { buildViewByKey } from 'bbmn-utils';\r\nimport ControlMixin from '../control-mixin/index.js';\r\nimport { CollectionView, View } from 'backbone.marionette';\r\nimport { isClass } from 'bbmn-core';\r\n\r\n\r\n\r\nexport default Base => {\r\n\tif (Base == null) {\r\n\t\tBase = CollectionView;\r\n\t}\r\n\r\n\tif (!isClass(Base, CollectionView)) {\r\n\t\tthrow new Error('controlView mixin can be applied only on marionette CollectionView');\r\n\t}\r\n\r\n\tlet Mixed = Base;\r\n\r\n\tif (Mixed.ControlViewMixin) {\r\n\t\treturn Mixed;\r\n\t}\r\n\r\n\tif (!Mixed.ControlMixin) {\r\n\t\tMixed = ControlMixin(Mixed);\r\n\t}\r\n\r\n\tif (!Mixed.CssClassModifiersMixin) {\r\n\t\tMixed = cssClassModifiersMixin(Mixed);\r\n\t}\r\n\r\n\tif (!Mixed.CustomsMixin) {\r\n\t\tMixed = customsMixin(Mixed);\r\n\t}\r\n\r\n\r\n\treturn Mixed.extend({\r\n\r\n\t\trenderAllCustoms: true,\r\n\t\tisControlWrapper: true,\r\n\t\tskipFirstValidationError: true,\r\n\t\tshouldShowError: false,\r\n\t\tvalidateOnReady: false,\r\n\t\t\r\n\t\tconstructor(){\r\n\t\t\tMixed.apply(this, arguments);\r\n\t\t\tif(!this.cssClassModifiers) {\r\n\t\t\t\tthis.cssClassModifiers = [];\r\n\t\t\t}\r\n\t\t\tthis._setControlValidInvalidListeners();\r\n\t\t\tthis.addCssClassModifier('control-wrapper');\r\n\t\t},\r\n\r\n\t\t_setControlValidInvalidListeners(){\r\n\t\t\tif(this._controlValidInvalidListeners) { return true; }\r\n\r\n\t\t\tthis.on({\r\n\t\t\t\t'control:valid': this._onControlValid,\r\n\t\t\t\t'control:invalid': this._onControlInvalid\r\n\t\t\t});\r\n\t\t\tif(this.getOption('validateOnReady')){\r\n\t\t\t\tthis.once('customs:render', () => this.makeControlReady());\r\n\t\t\t}\t\t\t\r\n\r\n\t\t\tthis._controlValidInvalidListeners = true;\r\n\t\t},\r\n\r\n\t\tgetCustoms(){\r\n\t\t\tlet customs = [];\r\n\t\t\tif (this.getOption('isControlWrapper')) {\r\n\t\t\t\tcustoms.push(this.getControlView());\r\n\t\t\t} else {\r\n\t\t\t\tcustoms.push(...this._customs);\r\n\t\t\t}\r\n\t\t\tcustoms = this.injectSystemViews(customs);\r\n\t\t\treturn this._prepareCustoms(customs);\r\n\t\t},\r\n\r\n\t\t_setupCustom(view){\r\n\t\t\tthis._setupChildControl(view);\r\n\t\t\tthis.setupCustom(view);\r\n\t\t},\r\n\t\t_setupChildControl(view){\r\n\t\t\tif(_.isFunction(view.setParentControl)) {\r\n\t\t\t\tview.setParentControl(this);\r\n\t\t\t}\r\n\t\t\tthis.setupChildControl(view);\r\n\t\t},\r\n\t\tsetupChildControl: _.noop,\r\n\t\tinjectSystemViews(customs = []){\r\n\t\t\tcustoms.unshift(this.getHeaderView());\r\n\t\t\tcustoms.push(\r\n\t\t\t\tthis.getErrorView(),\r\n\t\t\t\tthis.getFooterView()\t\r\n\t\t\t);\r\n\t\t\treturn customs;\r\n\t\t},\r\n\r\n\r\n\r\n\r\n\t\tgetErrorView(){\r\n\t\t\tif (!this.getOption('shouldShowError')) { return; }\r\n\t\t\tif (this.getOption('showValidateError', {force:false})) { return; }\r\n\t\t\tthis._errorView = this.buildErrorView();\r\n\t\t\treturn this._errorView;\r\n\t\t},\r\n\t\tbuildErrorView(){\r\n\t\t\treturn buildViewByKey.call(this, 'errorView');\r\n\t\t},\r\n\r\n\r\n\r\n\t\tgetHeaderView(){\t\t\t\r\n\t\t\treturn this.buildHeaderView({ tagName: 'header' });\r\n\t\t},\r\n\t\tbuildHeaderView(options){\r\n\t\t\treturn this._buildNestedTextView('header', options);\r\n\t\t},\r\n\t\t_buildNestedTextView(key, options){\r\n\t\t\tlet TextView = this.getOption('TextView');\r\n\t\t\tlet buildText;\r\n\t\t\tif (!TextView) {\r\n\t\t\t\tbuildText = (text, opts) => new View(_.extend({}, opts, { template: () => text }));\r\n\t\t\t}\r\n\t\t\treturn buildViewByKey.call(this, key, { TextView, buildText, options });\r\n\t\t},\r\n\r\n\r\n\t\tgetFooterView(){\r\n\t\t\tif (this.getOption('buttonsInFooter')) {\r\n\t\t\t\treturn this.buildButtonsView();\r\n\t\t\t} else {\r\n\t\t\t\treturn this.buildFooterView();\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tbuildFooterView(){\r\n\t\t\treturn this._buildNestedTextView('footer', { tagName: 'footer' });\r\n\t\t},\r\n\r\n\t\tbuildButtonsView(){\r\n\t\t\tif (this._buttonsView) {\r\n\t\t\t\tthis.stopListening(this._buttonsView);\r\n\t\t\t}\r\n\r\n\t\t\tlet options = this.buildButtonsOptions();\r\n\t\t\tlet view = buildViewByKey.call(this, 'buttonsView', { options });\r\n\t\t\tif (!view) { return; }\r\n\r\n\t\t\tthis._buttonsView = view;\r\n\t\t\tthis.settleButtonsListeners(view);\r\n\r\n\t\t\treturn view;\r\n\t\t},\r\n\t\tbuildButtonsOptions(){\r\n\t\t\tlet btns = this.getOption('buttons');\r\n\t\t\tif(btns) {\r\n\t\t\t\treturn _.reduce(btns, (hash, b) => {\r\n\t\t\t\t\tlet item = this.buildButton(b, this);\r\n\t\t\t\t\thash[item.name] = item;\r\n\t\t\t\t\treturn hash;\r\n\t\t\t\t}, {});\r\n\t\t\t}\t\t\r\n\t\t},\r\n\t\tbuildButton(value){\r\n\t\t\tif (_.isString(value)) {\r\n\t\t\t\treturn this.buildButton({ text: value, className: value, name: value });\r\n\t\t\t} else if(_.isFunction(value)) {\r\n\t\t\t\treturn this.buildButton(value.call(this));\r\n\t\t\t} else if(_.isObject(value)) {\r\n\t\t\t\treturn this.fixButton(value);\r\n\t\t\t}\r\n\t\t},\r\n\t\tfixButton(button){\r\n\t\t\treturn button;\r\n\t\t},\r\n\t\tsettleButtonsListeners(buttonsView){\r\n\t\t\tthis.listenTo(buttonsView, {\r\n\t\t\t\t'resolve'(){\r\n\t\t\t\t\tthis.triggerMethod('resolve', this.getControlValue());\r\n\t\t\t\t},\r\n\t\t\t\t'reject'(){\r\n\t\t\t\t\tthis.triggerMethod('reject');\r\n\t\t\t\t},\r\n\t\t\t\t'reject:soft'(){\r\n\t\t\t\t\tthis.triggerMethod('reject:soft');\r\n\t\t\t\t},\r\n\t\t\t\t'reject:hard'(){\r\n\t\t\t\t\tthis.triggerMethod('reject:hard');\r\n\t\t\t\t},\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\tgetControlView(){\r\n\t\t\tthis.control = buildViewByKey.call(this, 'controlView', { options: { parentControl: this, value: this.getControlValue() } });\r\n\t\t\treturn this.control;\r\n\t\t},\r\n\r\n\r\n\t\t_onControlInvalid(value, error){\r\n\t\t\tthis.disableButtons();\r\n\t\t\tthis._showValidateError(error);\r\n\t\t},\r\n\t\t_onControlValid(){\r\n\t\t\tthis.enableButtons();\r\n\t\t\tthis._hideValidateError();\r\n\t\t},\r\n\t\t\r\n\t\tdisableButtons(){\r\n\t\t\tif(this._buttonsView && _.isFunction(this._buttonsView.disableButton)) {\r\n\t\t\t\tthis._buttonsView.disableButton('resolve');\r\n\t\t\t}\r\n\t\t},\r\n\t\tenableButtons(){\r\n\t\t\tif(this._buttonsView && _.isFunction(this._buttonsView.enableButton)) {\r\n\t\t\t\tthis._buttonsView.enableButton('resolve');\r\n\t\t\t}\r\n\t\t},\r\n\t\t_showValidateError(error){\r\n\t\t\t\r\n\t\t\tlet shouldShow = this.getOption('shouldShowError');\r\n\t\t\tlet skipFirstValidationError = this.getOption('skipFirstValidationError');\r\n\r\n\t\t\tif (skipFirstValidationError && !this._firstValidationErrorSkipped) {\r\n\t\t\t\tthis._firstValidationErrorSkipped = true;\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tif (!shouldShow) return;\r\n\r\n\t\t\tlet show = this.getOption('showValidateError', { force: false });\r\n\t\t\tif (_.isFunction(show)) {\r\n\t\t\t\tshow.call(this, error);\r\n\t\t\t} else {\r\n\t\t\t\tif (!this._errorView) return;\r\n\t\t\t\tthis._errorView.showError(error);\r\n\t\t\t}\t\t\r\n\t\t},\r\n\t\t_hideValidateError(){\r\n\t\t\tlet hide = this.getOption('hideValidateError', { force: false });\r\n\t\t\tif (_.isFunction(hide)) {\r\n\t\t\t\thide.call(this);\r\n\t\t\t} else {\r\n\t\t\t\tif (!this._errorView) return;\r\n\t\t\t\tthis._errorView.hideError();\r\n\t\t\t}\t\t\r\n\t\t},\r\n\t}, { ControlViewMixin: true });\r\n\r\n\r\n};\r\n","import _ from 'underscore';\r\n\r\nimport { CollectionView, View } from 'backbone.marionette';\r\nimport { isClass } from 'bbmn-core';\r\nimport { cssClassModifiersMixin } from 'bbmn-mixins';\r\nimport buttonMixin from '../button/index.js';\r\n\r\nexport default Base => {\r\n\tif (Base == null) {\r\n\t\tBase = CollectionView;\r\n\t}\r\n\r\n\tif(!isClass(Base, CollectionView)){\r\n\t\tthrow new Error('promiseBar mixin can be applied only on CollectionView');\r\n\t}\r\n\r\n\tlet Mixed = Base;\r\n\r\n\tif (!Mixed.CssClassModifiersMixin) {\r\n\t\tMixed = cssClassModifiersMixin(Mixed);\r\n\t}\r\n\r\n\treturn Mixed.extend({\r\n\t\tconstructor(options){\r\n\t\t\tthis._buttons = {};\r\n\t\t\tBase.apply(this, arguments);\r\n\t\t\tthis.addPromiseBarCssClass();\r\n\t\t\tthis.mergeOptions(options, ['promise', 'reject', 'resolve', 'beforeRejectSoft', 'beforeRejectHard', 'beforeResolve']);\r\n\t\t},\r\n\t\ttagName: 'footer',\r\n\t\tresolve:'ok',\r\n\t\ttriggerNameEvent: true,\r\n\t\taddPromiseBarCssClass(){\r\n\t\t\tthis.addCssClassModifier('promise-bar');\r\n\t\t},\r\n\t\tonRender(){\r\n\t\t\tthis.addButtons();\r\n\t\t},\r\n\t\taddButtons(){\r\n\t\t\tlet buttons = this.buildButtons() || [];\r\n\t\t\twhile (buttons.length){\r\n\t\t\t\tlet button = buttons.pop();\r\n\t\t\t\tlet preventRender = !!buttons.length;\r\n\t\t\t\tthis.addChildView(button, { preventRender });\r\n\t\t\t}\r\n\t\t},\r\n\t\tbuildButtons(){\r\n\t\t\tlet names = ['resolve','rejectSoft','rejectHard'];\r\n\t\t\treturn _.reduce(names, (buttons, name) => {\r\n\t\t\t\tlet button = this.buildButton(name);\r\n\t\t\t\tbutton && buttons.push(button);\r\n\t\t\t\treturn buttons;\r\n\t\t\t}, []);\r\n\t\t},\r\n\t\tbuildButton(name){\r\n\t\t\tlet options = this.getButtonOptions(name);\r\n\t\t\tif (!options) return;\r\n\t\t\tlet Button = this.getOption('buttonView');\r\n\t\t\tif (!Button) {\r\n\t\t\t\tButton = this.buttonView = buttonMixin(View);\r\n\t\t\t}\r\n\t\t\tlet btn = new Button(options);\r\n\t\t\tthis._buttons[name] = btn;\r\n\t\t\treturn btn;\r\n\t\t},\r\n\t\tgetButtonOptions(name){\r\n\t\t\tlet options = this.getOption(name);\r\n\t\t\tif ( !options ) return;\r\n\t\t\tif( _.isString(options) ) {\r\n\t\t\t\toptions = { text: options };\r\n\t\t\t} else if(!_.isObject(options)) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tlet defs = { \r\n\t\t\t\tclassName: name, \r\n\t\t\t\tname, \r\n\t\t\t\ttriggerNameEvent: this.getOption('triggerNameEvent'), \r\n\t\t\t\tstopEvent: true,\r\n\t\t\t\ttext: options.text || name,\r\n\t\t\t};\r\n\t\t\toptions = _.extend(defs, options);\r\n\t\t\treturn options;\r\n\t\t},\r\n\t\tchildViewEvents:{\r\n\t\t\t'click:resolve'(data){\r\n\t\t\t\tthis.triggerMethod('resolve', data);\r\n\t\t\t},\r\n\t\t\t'click:rejectSoft'(value){ \r\n\t\t\t\tthis.triggerMethod('reject', { type: 'soft', value });\r\n\t\t\t\tthis.triggerMethod('reject:soft', value);\r\n\t\t\t},\r\n\t\t\t'click:rejectHard'(value){ \r\n\t\t\t\tthis.triggerMethod('reject', { type: 'hard', value });\r\n\t\t\t\tthis.triggerMethod('reject:hard', value);\r\n\t\t\t},\r\n\t\t\t'click:fail'(error, name, event, view) {\r\n\t\t\t\tthis.triggerMethod('click:fail', error, name, event, view);\r\n\t\t\t\tif (name) {\r\n\t\t\t\t\tthis.triggerMethod(`click:${name}:fail`, error, event, view);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tdisableButton(name){\r\n\t\t\tlet btn = this._buttons[name];\r\n\t\t\tbtn && btn.disable();\r\n\t\t},\r\n\t\tenableButton(name){\r\n\t\t\tlet btn = this._buttons[name];\r\n\t\t\tbtn && btn.enable();\r\n\t\t},\r\n\r\n\t});\r\n\r\n};\r\n","import promiseBarMixin from './mixin';\r\nimport { CollectionView } from '../config';\r\nimport Button from '../button';\r\n\r\nexport default promiseBarMixin(CollectionView).extend({\r\n\tbuttonView: Button\r\n});\r\n\r\nexport {\r\n\tpromiseBarMixin\r\n};\r\n","import _ from 'underscore';\r\nimport { View, CollectionView } from '../config';\r\nimport controlViewMixin from './mixin';\r\nimport PromiseBar from '../promise-bar';\r\n\r\nconst textView = View.extend({\r\n\ttemplate: _.template('<%= text %>'),\r\n\ttemplateContext(){\t\t\r\n\t\treturn {\r\n\t\t\ttext: this.getOption('text')\r\n\t\t};\r\n\t}\r\n});\r\n\r\nconst ControlView = controlViewMixin(CollectionView).extend({\r\n\trenderAllCustoms: true,\r\n\tbuttonsView: PromiseBar,\r\n\ttextView,\r\n\tfixButton(btn){\r\n\t\tif (btn.name != btn.text) { return btn; }\r\n\r\n\t\tif (btn.text === 'rejectSoft') {\r\n\t\t\tbtn.text = 'cancel';\r\n\t\t}\r\n\r\n\t\treturn btn;\r\n\t}\r\n});\r\nexport default ControlView;\r\nexport {\r\n\tcontrolViewMixin,\r\n\tControlView\r\n};\r\n","import _ from 'underscore';\r\n\r\nexport default {\r\n\t_createSchema(){\r\n\t\tlet schema = this.getOption('schema', { args: [ this.model, this ] });\r\n\t\tlet Schema = this.getSchemaClass();\r\n\r\n\t\tif(schema instanceof Schema){\r\n\t\t\treturn schema;\r\n\t\t}\r\n\r\n\t\t\r\n\t\tif(schema == null || _.isObject(schema)) {\r\n\t\t\treturn this.createSchema(Schema, schema);\r\n\t\t}\r\n\t\t\r\n\t},\r\n\tgetSchema(){\r\n\t\tif(this._schema) { return this._schema; }\r\n\t\t\r\n\t\tthis._schema = this._createSchema();\r\n\t\treturn this._schema;\r\n\t},\r\n\tcreateSchema(Schema, options = {}){\r\n\t\treturn new Schema(options);\r\n\t},\r\n\tgetSchemaClass(){\r\n\t\treturn this.getOption('schemaClass');\r\n\t},\r\n};\r\n","import _ from 'underscore';\r\n\r\nimport { validator, PropertySchema } from 'bbmn-components';\r\n\r\nimport { mix, buildViewByKey } from 'bbmn-utils';\r\n\r\nimport ControlView from '../control-view/index.js';\r\nimport common from './common.js';\r\nimport { View } from 'backbone.marionette';\r\n\r\nexport default Base => {\r\n\tconst Mixed = mix(Base).with(ControlView, common);\r\n\r\n\treturn Mixed.extend({\r\n\t\t\r\n\t\tshouldShowError: true,\r\n\t\tclassName:'edit-model-property',\r\n\t\tschemaClass: PropertySchema,\r\n\t\tdebounceChildControlEvents: 0,\r\n\r\n\r\n\t\tgetDefaultValidateRule(options){\r\n\t\t\tlet schema = this.getSchema();\r\n\t\t\tlet rule = _.extend({}, schema.getType(options), schema.getValidation(options));\r\n\t\t\treturn rule;\r\n\t\t},\r\n\t\tgetValidateRule(options = {}){\r\n\t\t\tlet rule = this.getDefaultValidateRule(options);\r\n\t\t\treturn rule;\r\n\t\t},\r\n\t\t\r\n\t\tgetHeaderView(){\r\n\t\t\treturn this._getHeaderView();\r\n\t\t},\r\n\t\t_getHeaderView(){\r\n\t\t\tlet TextView = this.getOption('textView');\r\n\t\t\tlet buildText;\r\n\t\t\tif (!TextView) {\r\n\t\t\t\tbuildText = (text, opts) => new View(_.extend({}, opts, { template: () => text }));\r\n\t\t\t}\r\n\t\t\tlet view = buildViewByKey.call(this, 'header', { TextView, buildText, options: { tagName: 'header' } });\r\n\t\t\tif(view) { return view; }\r\n\r\n\t\t\tif(this.getOption('propertyLabelAsHeader')) {\r\n\t\t\t\tlet label = this.getSchema().getLabel();\r\n\t\t\t\tif(TextView) {\r\n\t\t\t\t\treturn new TextView({ text: label, tagName: 'header'});\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn new View({ template: () => label, tagName: 'header'});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tgetControlView(){\r\n\t\t\tlet options = {\r\n\t\t\t\tvalue: this.getControlValue(),\r\n\t\t\t\tallValues: this.getParentControlValue(),\t\t\t\t\r\n\t\t\t};\r\n\t\t\tlet editOptions = this.getSchema().getEdit(options);\r\n\t\t\treturn this.buildPropertyView(editOptions);\r\n\t\t},\r\n\t\tcontrolValidate(value, allValues){\r\n\t\t\tlet rule = this.getValidateRule({ value, allValues });\r\n\t\t\tif(!rule || !_.size(rule)) return;\r\n\t\t\treturn validator.validate(value, rule, { allValues });\r\n\t\t},\r\n\t\t\r\n\t\t// must be overrided\r\n\t\t// accepts:\toptions arguments.\r\n\t\t// returns:\tshould return Control instance\r\n\t\tbuildPropertyView(){\r\n\t\t\tthrow new Error('buildPropertyView not implemented. You should build view by your own');\r\n\t\t},\r\n\r\n\t});\r\n};\r\n","import _ from 'underscore';\r\nimport ControlView from '../control-view/index.js';\r\nimport common from './common.js';\r\nimport { mix } from 'bbmn-utils';\r\nimport EditProperty from './property.js';\r\n\r\nimport { ModelSchema } from 'bbmn-components';\r\n\r\n\r\nexport default Base => {\r\n\tlet Mixed = mix(Base).with(ControlView, common);\r\n\r\n\treturn Mixed.extend({\r\n\t\t\r\n\t\tvalidateOnReady: true,\r\n\t\tbuttonsInFooter: true,\r\n\t\tisControlWrapper: false,\r\n\t\tschemaClass: ModelSchema,\r\n\t\teditPropertyClass: EditProperty,\r\n\r\n\t\tpropertyLabelAsHeader: true,\r\n\r\n\t\tclassName:'edit-model-control',\r\n\r\n\t\tgetCustoms(){\r\n\t\t\tlet customs = [];\r\n\t\t\tcustoms.push(...this.getPropertiesViews());\r\n\t\t\tcustoms.push(...this._customs);\r\n\t\t\tcustoms = this.injectSystemViews(customs);\r\n\t\t\treturn this._prepareCustoms(customs);\r\n\t\t},\r\n\t\tgetPropertiesViews(){\r\n\t\t\tlet modelSchema = this.getSchema();\r\n\t\t\tlet propertiesToShow = this.getOption('propertiesToShow', { args: [ this.model, this ]}) || [];\r\n\t\t\tif(!propertiesToShow.length) {\r\n\t\t\t\tpropertiesToShow = modelSchema.getPropertiesNames();\r\n\t\t\t}\r\n\t\t\treturn _.map(propertiesToShow, name => this._createEditProperty(name, modelSchema));\r\n\t\t},\r\n\t\t_createEditProperty(name, modelSchema){\r\n\t\t\tlet schema = modelSchema.getProperty(name, { create: true });\r\n\t\t\tlet EditProperty = this.getEditPropertyClass();\r\n\t\t\tconst def = {\r\n\t\t\t\tcontrolName: name,\r\n\t\t\t\tschema,\r\n\t\t\t\tvalue: this.getPropertyValue(name),\r\n\t\t\t\tallValues: this.getControlValue({ notValidated: true }),\r\n\t\t\t\tpropertyLabelAsHeader: this.getOption('propertyLabelAsHeader')\r\n\t\t\t};\r\n\t\t\tlet options = this.getEditPropertyOptions(def);\r\n\t\t\treturn this.createEditProperty(EditProperty, options);\r\n\t\t},\r\n\t\tgetPropertyValue(property){\r\n\t\t\treturn this.getControlValue(property);\r\n\t\t},\r\n\t\tgetEditPropertyClass(){\r\n\t\t\treturn this.getOption('editPropertyClass');\r\n\t\t},\r\n\t\tgetEditPropertyOptions(defaultOptions){\r\n\t\t\treturn _.extend({}, defaultOptions, this.getOption('editPropertyOptions'));\r\n\t\t},\r\n\t\tcreateEditProperty(EditProperty, options){\r\n\t\t\treturn new EditProperty(options);\r\n\t\t},\r\n\r\n\t});\r\n};\r\n","import _ from 'underscore';\r\nimport { getOption } from 'bbmn-utils';\r\nconst _getOption = (context, key, checkAlso) => getOption(context, key, { args:[context], checkAlso });\r\n\r\nexport default function getInputType(inputView, opts = {}){\r\n\t\r\n\tlet valueType = _getOption(inputView, 'valueType', opts);\r\n\tif (valueType == null) {\r\n\t\tlet value = inputView.getControlValue();\r\n\t\tif ( value == null) {\r\n\t\t\tvalueType = 'string';\r\n\t\t} else {\r\n\t\t\tif(_.isNumber(value))\r\n\t\t\t\tvalueType = 'number';\r\n\t\t\telse if(_.isDate(value))\r\n\t\t\t\tvalueType = 'datetime';\r\n\t\t\telse\r\n\t\t\t\tvalueType = 'string';\r\n\t\t}\t\t\r\n\t}\r\n\r\n\tif (valueType == 'number') {\r\n\t\tinputView._valueIsNumber = true;\r\n\t}\r\n\r\n\tlet type = _getOption(inputView, 'inputType', opts);\r\n\tif(type == null){\r\n\t\ttype = _getOption(inputView.valueOptions, 'inputType', opts.valueOptions);\r\n\t}\r\n\tif (!type) {\r\n\t\tif (inputView._valueIsNumber) {\r\n\t\t\ttype = _getOption(inputView, 'inputNumberType', opts) || 'number';\r\n\t\t} else if (valueType == 'string') {\r\n\t\t\ttype = 'text';\r\n\t\t} else if (valueType == 'datetime') {\r\n\t\t\ttype = 'datetime';\r\n\t\t} else {\r\n\t\t\ttype = 'text';\r\n\t\t}\r\n\t}\r\n\tinputView.inputType = type;\r\n\tinputView.valueType = valueType;\r\n\treturn type;\r\n}\r\n","import _ from 'underscore';\r\nimport getInputType from './get-input-type.js';\r\n\r\nimport { getOption } from 'bbmn-utils';\r\n\r\nexport default function setInputAttributes(inputView, opts = {}) {\r\n\r\n\tlet attributes = getOption(inputView, opts, 'attributes');\r\n\r\n\tlet check = _.extend({}, inputView, opts, inputView.valueOptions, opts.valueOptions);\r\n\r\n\tlet restrictionKeys = {\r\n\t\t'maxLength':'maxlength', \r\n\t\t'minLength':'minlength',\r\n\t\t'minValue':'min', \r\n\t\t'maxValue':'max', \r\n\t\t'valuePattern':'pattern',\r\n\t\t'required':'required',\r\n\t\t'value':'value'\r\n\t};\r\n\tlet restrictions = {};\r\n\t_(restrictionKeys).each((key2, key) => {\r\n\t\tlet value = check[key];\r\n\t\tif (value != null)\r\n\t\t\trestrictions[key2] = value;\r\n\t});\r\n\r\n\tinputView.attributes = _.extend({\r\n\t\tvalue: inputView.value,\r\n\t\ttype: getInputType(inputView, opts),\r\n\t}, restrictions, attributes);\r\n\t\r\n\tif(opts.attributes)\r\n\t\tdelete opts.attributes;\r\n}\r\n","import { getOption } from 'bbmn-utils';\r\nexport default (context, key, ifNull) => getOption(context, key, { args:[context], default: ifNull });\r\n\r\n","export default function isChar(event){\r\n\treturn event.key && event.key.length == 1 && !event.ctrlKey;\r\n}","import getOption from './_get-option.js';\r\nimport isChar from './_is-char.js';\r\nexport default function(eventContext) {\r\n\tlet { context, event } = eventContext;\r\n\r\n\tif (context.triggerMethod('keydown', event) === false) { return; }\r\n\r\n\r\n\tlet prevent = false;\r\n\tlet stop = false;\r\n\r\n\tif (isChar(event)) {\r\n\t\tif (!context.isEnteredCharValid(event.key)) {\r\n\t\t\tprevent = true;\r\n\t\t}\r\n\t}\r\n\tif(event.keyCode == 13 && getOption(context, 'doneOnEnter', true)){\r\n\t\tprevent = true;\r\n\t\tstop = true;\r\n\t}\r\n\r\n\tstop && event.stopPropagation();\r\n\tprevent && event.preventDefault();\r\n}\r\n","import getOption from './_get-option.js';\r\nexport default function(eventContext) {\r\n\tlet { context, event } = eventContext;\r\n\r\n\tif (context.triggerMethod('keyup', event) === false) { return; }\r\n\r\n\tif (event.keyCode == 13) {\r\n\t\t\r\n\t\tlet shouldDone = getOption(context, 'doneOnEnter', true);\r\n\t\tif (shouldDone) {\r\n\r\n\t\t\tevent.stopPropagation();\r\n\t\t\tevent.preventDefault();\r\n\t\t\tcontext.controlDone();\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\r\n}\r\n","export default function(eventContext) {\r\n\tlet { context, event } = eventContext;\r\n\r\n\t\r\n\tif (context.triggerMethod('paste', event) === false) { return; }\r\n\r\n\r\n\tlet text = event.originalEvent.clipboardData.getData('text/plain');\r\n\tif (!text) return;\r\n\tif (!context.isValueValid(text)) {\r\n\t\tevent.preventDefault();\r\n\t\tevent.stopPropagation();\r\n\t}\r\n}\r\n","import getOption from './_get-option.js';\r\nexport default function(eventContext) {\r\n\tlet { context } = eventContext;\r\n\r\n\tif (context.triggerMethod('blur', event) === false) { return; }\r\n\r\n\r\n\tif (getOption(context, 'doneOnBlur', true)) {\r\n\t\tcontext.controlDone();\r\n\t}\r\n}\r\n","import getOption from './_get-option.js';\r\nexport default function(eventContext) {\r\n\tlet { context, input } = eventContext;\r\n\r\n\tif (context.triggerMethod('focus', event) === false) { return; }\r\n\r\n\tif (getOption(context, 'selectOnFocus', true)) {\r\n\t\tinput.select();\r\n\t}\r\n}\r\n","export default function(eventContext) {\r\n\r\n\tlet { context, input, event } = eventContext;\r\n\r\n\tif (context.triggerMethod('input', event) === false) { return; }\r\n\r\n\r\n\tcontext.setControlValue(event.target.value).then(newvalue => {\r\n\t\tif (event.target.value != (newvalue || '').toString()) {\r\n\t\t\tinput.value = newvalue;\r\n\t\t}\r\n\t});\r\n\r\n}\r\n","import keydown from './keydown.js';\r\nimport keyup from './keyup.js';\r\nimport paste from './paste.js';\r\nimport blur from './blur.js';\r\nimport focus from './focus.js';\r\nimport input from './input.js';\r\n\r\nexport default {\r\n\tkeydown, \r\n\t//keypress,\r\n\tkeyup,\r\n\tpaste,\r\n\tblur,\r\n\tfocus,\r\n\tinput,\r\n\t//'js:change': jsChange\r\n};\r\n","import _ from 'underscore';\r\nimport { camelCase } from 'bbmn-utils';\r\nimport events from './events/index.js';\r\nexport default function handleInputEvent(control, eventName, event) {\r\n\tlet options = _.extend({\r\n\t\tcontext: control,\r\n\t\tinput: control.el,\r\n\t\trestrictions: control.restrictions,\r\n\t\teventName,\r\n\t\tevent\r\n\t});\r\n\r\n\r\n\tlet method = camelCase(`on:dom:${eventName}`);\r\n\r\n\tif (_.isFunction(events[eventName])) {\r\n\t\tevents[eventName].call(control, options);\r\n\t} \r\n\t\r\n\tif (_.isFunction(control[method])) {\r\n\t\tcontrol[method](event, options);\r\n\t} \r\n}\r\n","import _ from 'underscore';\r\nimport handleEvent from './handle-event.js';\r\nimport eventHandlers from './events/index.js';\r\nimport { getOption } from 'bbmn-utils';\r\n\r\n\r\nconst _getOption = (context, key, checkAlso) => \r\n\tgetOption(context, key, { args:[context], checkAlso });\r\n\r\nexport default function setInputEvents(inputView, opts = {}) {\r\n\r\n\tlet passedEvents = _getOption(inputView, 'events', opts);\t\r\n\r\n\tlet eventsArray = _(eventHandlers).keys();\t\r\n\tlet events = _.reduce(eventsArray, (Memo, eventName) => {\r\n\t\tMemo[eventName] = function(event){ \r\n\t\t\thandleEvent(this, eventName, event); \r\n\t\t};\r\n\t\treturn Memo;\r\n\t}, {});\r\n\tinputView.events = _.extend(events, passedEvents);\r\n}\r\n","import _ from 'underscore';\r\nimport { convertString as convert, getOption } from 'bbmn-utils';\r\n\r\nimport ControlMixin from '../control-mixin/index.js';\r\nimport setInputAttributes from './set-attributes.js';\r\nimport setInputEvents from './set-events.js';\r\n\r\n//import { convertString as convert, getOption } from '../../../utils/index.js';\r\nexport default Base => {\r\n\r\n\tlet Mixin = Base.ControlMixin ? Base : ControlMixin(Base);\r\n\r\n\treturn Mixin.extend({\r\n\t\tconstructor(opts){\r\n\t\t\t\r\n\t\t\tthis._initControl(opts);\r\n\r\n\t\t\tsetInputAttributes(this, opts);\r\n\t\t\tsetInputEvents(this, opts);\r\n\t\t\tMixin.apply(this, arguments);\r\n\r\n\t\t\tif (!_.isFunction(this.getOption)) {\r\n\t\t\t\tthis.getOption = (...args) => getOption(this, ...args);\r\n\t\t\t}\r\n\r\n\t\t\tthis.buildRestrictions();\r\n\t\t\tlet value = this.getOption('value') || '';\t\t\t\r\n\t\t\tthis.el.value = value;\r\n\t\t\t//this.setControlValue(value, { trigger: false, silent: true });\r\n\t\t},\r\n\t\ttagName:'input',\r\n\t\ttemplate: false,\r\n\t\tdoneOnEnter: true,\r\n\t\tdoneOnBlur: true,\r\n\t\tbuildRestrictions(){\r\n\t\t\tlet attrs = _.result(this, 'attributes');\r\n\t\t\tlet pickNumbers = ['maxlength', 'minlength', 'min', 'max'];\r\n\t\t\tlet pickStrings = ['pattern'];\r\n\t\t\tlet pickBools = ['required'];\r\n\t\t\tlet restrictions = {};\r\n\t\t\t_(attrs).each((value, key) => {\r\n\t\t\t\tlet pick = false;\r\n\t\t\t\tkey = key.toLowerCase();\r\n\t\t\t\tif (pickNumbers.indexOf(key) > -1) {\r\n\t\t\t\t\tvalue = convert(value, 'number');\r\n\t\t\t\t\tpick = true;\r\n\t\t\t\t} else if (pickStrings.indexOf(key) > -1) {\r\n\t\t\t\t\tpick = true;\r\n\t\t\t\t} else if (pickBools.indexOf(key) > -1) {\r\n\t\t\t\t\tpick = true;\r\n\t\t\t\t\tvalue = convert(value, 'boolean', { returnNullAndEmptyAs: true, returnOtherAs: true });\r\n\t\t\t\t}\r\n\t\t\t\tpick && (restrictions[key] = value);\r\n\t\t\t});\r\n\t\t\tthis.restrictions = restrictions;\t\t\r\n\t\t},\r\n\t\tprepareValueBeforeSet(value){\r\n\t\t\tif (value == null || value === '') return value;\r\n\t\t\t\r\n\t\t\tlet len = this.getMaxLength();\r\n\t\t\tif (len > 0) {\r\n\t\t\t\tvalue = value.toString().substring(0, len);\r\n\t\t\t}\r\n\t\t\tif (this._valueIsNumber) {\r\n\t\t\t\tlet num = convert(value, 'number');\r\n\t\t\t\tif(isNaN(num))\r\n\t\t\t\t\treturn;\r\n\t\t\t\tlet min = this.restrictions.min;\r\n\t\t\t\tlet max = this.restrictions.max;\r\n\t\t\t\t!isNaN(min) && num < min && (num = min);\r\n\t\t\t\t!isNaN(max) && num > max && (num = max);\r\n\t\t\t\treturn num;\r\n\t\t\t}\r\n\t\t\treturn value;\r\n\t\t},\r\n\t\tgetValueType(){\r\n\t\t\treturn this.valueType;\r\n\t\t},\r\n\t\tconvertValue(value){\r\n\t\t\treturn convert(value, this.getValueType());\r\n\t\t},\t\t\r\n\t\tgetMaxLength()\r\n\t\t{\r\n\t\t\treturn this.restrictions.maxlength;\r\n\r\n\t\t},\r\n\t\tisLengthValid(){\r\n\t\t\tlet value = this.getControlValue();\r\n\t\t\tlet len = this.getMaxLength();\r\n\t\t\treturn len == null || value.length < len;\r\n\t\t},\r\n\t\tisEnteredCharValid(char) {\r\n\t\t\tlet type = this.getValueType();\r\n\r\n\t\t\tif (type == 'number') {\r\n\t\t\t\treturn ['.','-'].indexOf(char) > -1 || !isNaN(parseInt(char, 10));\r\n\t\t\t} else {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t},\r\n\t\tisValueValid(value){\r\n\t\t\tlet type = this.getValueType();\r\n\t\t\tif (type == 'number') {\r\n\t\t\t\treturn !isNaN(parseFloat(value, 10));\r\n\t\t\t} else {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t},\r\n\t\tcontrolValidate(value){\r\n\t\t\tif (value == null || value === '') {\r\n\t\t\t\tif(this.restrictions.required)\r\n\t\t\t\t\treturn 'required';\r\n\t\t\t\telse if (this.restrictions.minLength > 0) {\r\n\t\t\t\t\treturn 'length:small';\r\n\t\t\t\t}\r\n\t\t\t\telse\r\n\t\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tlet strValue = value.toString();\r\n\t\t\tif (_.isNumber(this.restrictions.maxlength) && strValue.length > this.restrictions.maxlength)\r\n\t\t\t\treturn 'length:big';\r\n\t\t\tif (this._valueIsNumber) {\r\n\t\t\t\tif (!_.isNumber(value))\r\n\t\t\t\t\treturn 'not:number';\r\n\t\t\t\tif (_.isNumber(this.restrictions.min) && value < this.restrictions.min)\r\n\t\t\t\t\treturn 'less:than:min';\r\n\t\t\t\tif (_.isNumber(this.restrictions.max) && value > this.restrictions.max)\r\n\t\t\t\t\treturn 'greater:than:max';\r\n\t\t\t}\r\n\t\t\tif (this.restrictions.pattern) {\r\n\t\t\t\tlet pattern = RegExp(this.restrictions.pattern);\r\n\t\t\t\tif (pattern.test(strValue)) {\r\n\t\t\t\t\treturn 'pattern:mismatch';\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n};\r\n","import { View } from '../config';\r\nimport inputMixin from './mixin';\r\n\r\nexport default inputMixin(View);\r\nexport {\r\n\tinputMixin\r\n};\r\n","import _ from 'underscore';\r\n\r\nimport { View } from '../config';\r\nimport Control from '../control-view';\r\nimport { camelCase } from 'bbmn-utils';\r\nimport { inputMixin } from '../input';\r\n\r\nconst TextArea = inputMixin(View).extend({\r\n\tdoneOnEnter: false,\r\n\ttagName:'textarea',\r\n\ttemplate: data => data.value,\r\n\ttemplateContext(){\r\n\t\treturn {\r\n\t\t\tvalue: this.getControlValue()\r\n\t\t};\r\n\t}\r\n});\r\n\r\n\r\nconst inputEvents = ['focus','blur','input','keyup','keydown'];\r\n\r\nexport default Control.extend({\r\n\t\r\n\tconstructor(){\r\n\t\tControl.apply(this, arguments);\r\n\t\tthis.addCssClassModifier('control-textarea');\r\n\t},\r\n\tcontrolView: TextArea,\r\n\tcontrolViewOptions(){\r\n\t\tlet attributes = this.getOption('inputAttributes');\r\n\r\n\t\tlet options = {\r\n\t\t\tvalueOptions: this.getOption('valueOptions')\r\n\t\t};\r\n\t\tif (attributes) {\r\n\t\t\toptions.attributes = attributes;\t\t\t\r\n\t\t}\r\n\t\treturn _.extend(options, this._delegateInputEvents());\r\n\t},\r\n\t_delegateInputEvents(){\r\n\t\tlet delegatedHandlers = {};\r\n\t\t_.each(inputEvents, name => {\r\n\t\t\tlet handlerName = camelCase('on', name);\r\n\t\t\tlet handler = this.getOption(handlerName, { force: false });\r\n\t\t\tif(_.isFunction(handler)) {\r\n\t\t\t\tdelegatedHandlers[handlerName] = (...args) => {\r\n\t\t\t\t\treturn this.triggerMethod(name, ...args);\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn delegatedHandlers;\r\n\t}\r\n});\r\n","import Textarea from '../textarea';\r\n\r\n\r\nconst controls = {\r\n\t'textarea'(options = {}){\r\n\t\tlet value = options.value;\r\n\t\treturn new Textarea({ value });\r\n\t},\r\n\t'enum:buttons'(){},\r\n};\r\n\r\n\r\nexport default function getControlByString(name, options = {}){\r\n\tlet build = controls[name];\r\n\tif(!build) return;\r\n\treturn build(options);\r\n}\r\n","import _ from 'underscore';\r\nimport { isViewClass } from 'bbmn-utils';\r\nimport getControlByString from './get-control-by-string';\r\n\r\n\r\nfunction guesControl(options = {}){\r\n\tlet { valueOptions = {} } = options;\r\n\tlet { inputType } = valueOptions;\r\n\tif (inputType == 'textarea') {\r\n\t\treturn getControlByString('textarea', options);\r\n\t}\r\n}\r\n\r\n\r\nexport default function buildControl(options = {}){\r\n\tlet { valueOptions = {}, editOptions = {}, name, label, value } = options;\r\n\tlet { control } = editOptions;\r\n\t\r\n\tif (control) {\r\n\t\tif (isViewClass(control)) {\r\n\t\t\treturn new control(options);\r\n\t\t} else if (_.isString(control)) {\r\n\t\t\tcontrol = getControlByString(control, options);\r\n\t\t\tif (control) {\r\n\t\t\t\treturn control;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\treturn guesControl(options);\r\n\r\n}\r\n","import _ from 'underscore';\r\nimport editPropertyMixin from './property.js';\r\nimport editModelMixin from './model.js';\r\nimport { mix } from 'bbmn-utils';\r\nimport ControlView from '../control-view';\r\nimport Input from '../input';\r\nimport build from './build-control';\r\n\r\nconst BaseEditProperty = mix(ControlView).with(editPropertyMixin);\r\n\r\nconst EditProperty = BaseEditProperty.extend({\r\n\tbuildPropertyView(editOptions = {}){\r\n\t\t\r\n\t\tlet control = build(editOptions);\r\n\t\tif (control) { return control; }\r\n\r\n\t\tlet options = _.extend({}, editOptions, {\r\n\t\t\tinputAttributes:{\r\n\t\t\t\tname: editOptions.name,\r\n\t\t\t},\r\n\t\t});\r\n\r\n\t\treturn new Input(options);\r\n\t},\r\n});\r\n\r\nconst EditModel = mix(ControlView).with(editModelMixin).extend({\r\n\teditPropertyClass: EditProperty\r\n});\r\n\r\nexport {\r\n\teditPropertyMixin,\r\n\teditModelMixin,\r\n\tEditProperty,\r\n\tEditModel\r\n};\r\n"],"names":["Base","View","extend","options","apply","arguments","mergeOptions","_","template","e","stop","getOption","stopPropagation","preventDefault","beforeClick","then","triggerMethod","data","name","error","result","isFunction","Promise","resolve","$el","prop","buttonMixin","getTriggerMethod","context","trigger","ensureError","value","Error","length","_initControl","once","validate","catch","parent","getParentControl","_removeChildControl","children","getChildrenControls","each","child","_removeParentControl","_cntrl","control","off","index","indexOf","splice","controlName","getControlName","found","find","push","_controlInitialized","takeValue","_clone","initControlValue","initParentControl","_onControlDestroy","setParentControl","_addChildControl","initial","current","getControlValue","isValid","compareObjects","key","isObject","undefined","notValidated","clone","valueKey","getByPath","_prepareValueBeforeSet","isSameControlValue","_setControlValue","prepareValueBeforeSet","skipValidation","_onSetControlValueValidateSuccess","_validate","_onSetControlValueValidateFail","previous","isDone","_tryTriggerEvent","promise","_catch","_validatePromise","_onControlValidateSuccess","_onControlValidateFail","skipChildValidate","isControlWrapper","betterResult","args","reject","childrenErrors","childrenPromise","_validateChildrenControlsPromise","size","wrapped","_validateControlPromise","force","values","getParentControlValue","validateResult","call","errors","reduce","finaly","makeValid","silent","makeInvalid","event","childEvent","cce","def","defaultChildControlEvents","_debouncedChildControlEvents","dcce","defHandler","handler","handlerArguments","handlerName","delay","isNumber","debounce","isControlWraper","setControlValue","controlDone","isArray","slice","unflat","flat","namedEvent","handleChildControlEvent","parentTrigger","ControlMixin","CollectionView","isClass","Mixed","ControlViewMixin","CssClassModifiersMixin","cssClassModifiersMixin","CustomsMixin","customsMixin","cssClassModifiers","_setControlValidInvalidListeners","addCssClassModifier","_controlValidInvalidListeners","on","_onControlValid","_onControlInvalid","makeControlReady","customs","getControlView","_customs","injectSystemViews","_prepareCustoms","view","_setupChildControl","setupCustom","setupChildControl","noop","unshift","getHeaderView","getErrorView","getFooterView","_errorView","buildErrorView","buildViewByKey","buildHeaderView","tagName","_buildNestedTextView","TextView","buildText","text","opts","buildButtonsView","buildFooterView","_buttonsView","stopListening","buildButtonsOptions","settleButtonsListeners","btns","hash","b","item","buildButton","isString","className","fixButton","button","buttonsView","listenTo","parentControl","disableButtons","_showValidateError","enableButtons","_hideValidateError","disableButton","enableButton","shouldShow","skipFirstValidationError","_firstValidationErrorSkipped","show","showError","hide","hideError","_buttons","addPromiseBarCssClass","addButtons","buttons","buildButtons","pop","preventRender","addChildView","names","getButtonOptions","Button","buttonView","btn","defs","type","disable","enable","promiseBarMixin","textView","ControlView","controlViewMixin","PromiseBar","schema","model","Schema","getSchemaClass","createSchema","_schema","_createSchema","mix","with","common","PropertySchema","getSchema","rule","getType","getValidation","getDefaultValidateRule","_getHeaderView","label","getLabel","editOptions","getEdit","buildPropertyView","allValues","getValidateRule","validator","ModelSchema","EditProperty","getPropertiesViews","modelSchema","propertiesToShow","getPropertiesNames","map","_createEditProperty","getProperty","create","getEditPropertyClass","getPropertyValue","getEditPropertyOptions","createEditProperty","property","defaultOptions","_getOption","checkAlso","getInputType","inputView","valueType","isDate","_valueIsNumber","valueOptions","inputType","setInputAttributes","attributes","check","restrictionKeys","restrictions","key2","ifNull","default","isChar","ctrlKey","eventContext","prevent","isEnteredCharValid","keyCode","shouldDone","originalEvent","clipboardData","getData","isValueValid","input","select","target","newvalue","toString","handleInputEvent","eventName","el","method","camelCase","events","setInputEvents","passedEvents","eventsArray","eventHandlers","keys","Memo","Mixin","buildRestrictions","attrs","pickNumbers","pickStrings","pickBools","pick","toLowerCase","convert","returnNullAndEmptyAs","returnOtherAs","len","getMaxLength","substring","num","isNaN","min","max","getValueType","maxlength","char","parseInt","parseFloat","required","minLength","strValue","pattern","RegExp","test","inputMixin","TextArea","inputEvents","Control","_delegateInputEvents","delegatedHandlers","controls","Textarea","getControlByString","build","guesControl","buildControl","isViewClass","BaseEditProperty","editPropertyMixin","Input","EditModel","editModelMixin"],"mappings":"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"}