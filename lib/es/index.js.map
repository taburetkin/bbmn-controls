{"version":3,"file":"index.js","sources":["button/mixin.js","button/index.js","control-mixin/index.js","control-view/mixin.js","promise-bar/mixin.js","promise-bar/index.js","control-view/index.js","edit-schema/common.js","edit-schema/error-view.js","edit-schema/property.js","edit-schema/model.js","controls.js","edit-schema/index.js","input/get-input-type.js","input/set-attributes.js","input/events/_get-option.js","input/events/_is-char.js","input/events/keydown.js","input/events/keyup.js","input/events/paste.js","input/events/blur.js","input/events/focus.js","input/events/input.js","input/events/index.js","input/handle-event.js","input/set-events.js","input/mixin.js","input/index.js","textarea/index.js","select/selectable-view-mixin.js","select/childview.js","select/control.js","boolean-switch/index.js"],"sourcesContent":["import _ from 'underscore';\r\nimport { View } from 'backbone.marionette';\r\n\r\nexport default Base => {\r\n\tif (Base == null) {\r\n\t\tBase = View;\r\n\t}\r\n\treturn Base.extend({\r\n\r\n\t\ttriggerNameEvent: true,\r\n\t\tstopEvent: true,\r\n\t\tleftIcon: true,\r\n\t\trightIcon: true,\r\n\t\tforceText: true,\r\n\t\tbeforeClickIsAlwaysPromise: true,\r\n\t\tconstructor(options){\r\n\t\t\tBase.apply(this, arguments);\r\n\t\t\tthis.mergeOptions(options, ['name']);\r\n\t\t},\r\n\r\n\t\ttagName:'button',\r\n\t\tgetTemplate(){\r\n\t\t\tlet html = [];\r\n\t\t\tlet icon = '<i></i>';\r\n\t\t\t\r\n\t\t\tif (this.getOption('leftIcon')) {\r\n\t\t\t\thtml.push(icon);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tlet forceText = this.getOption('forceText');\r\n\t\t\tif (this.getText() || forceText) {\r\n\t\t\t\thtml.push('<span><%= text %></span>');\r\n\t\t\t}\r\n\r\n\t\t\tif (this.getOption('rightIcon')) {\r\n\t\t\t\thtml.push(icon);\r\n\t\t\t}\r\n\t\t\treturn _.template(html.join(''));\r\n\t\t},\r\n\t\tevents(){\r\n\t\t\tif(this.getOption('noevent')){\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tlet events = {\r\n\t\t\t\tclick(e) {\r\n\t\t\t\t\tlet stop = this.getOption('stopEvent');\r\n\t\t\t\t\tif (stop) {\r\n\t\t\t\t\t\te.stopPropagation();\r\n\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tlet before = this.beforeClick();\r\n\t\t\t\t\tif (before && before.then) {\r\n\t\t\t\t\t\tbefore.then(\r\n\t\t\t\t\t\t\tdata => this.triggerClick(data, e),\r\n\t\t\t\t\t\t\terror => this.triggerError(error, e)\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.triggerClick(before, e);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\treturn events;\r\n\t\t},\r\n\t\tbeforeClick(){\r\n\t\t\tlet result = this.triggerMethod('before:click');\r\n\t\t\tif(result && _.isFunction(result.then) ) {\r\n\t\t\t\treturn result;\r\n\t\t\t} else {\r\n\t\t\t\tif (this.getOption('beforeClickIsAlwaysPromise')) {\r\n\t\t\t\t\treturn Promise.resolve(result);\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn result;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\ttriggerClick(data, event){\r\n\t\t\tlet options = {\r\n\t\t\t\tevent,\r\n\t\t\t\tname: this.name,\r\n\t\t\t\tbuttonView: this,\r\n\t\t\t};\r\n\t\t\tthis.triggerMethod('click', data, options);\r\n\t\t\tif (this.name) {\r\n\t\t\t\tthis.triggerMethod('click:' + this.name, data, options);\r\n\t\t\t}\r\n\t\t},\r\n\t\ttriggerError(error, event){\r\n\t\t\tlet options = {\r\n\t\t\t\tevent,\r\n\t\t\t\tname: this.name,\r\n\t\t\t\tbuttonView: this,\r\n\t\t\t};\t\t\t\r\n\t\t\tthis.triggerMethod('click:fail', error, options);\r\n\t\t\tif (this.name) {\r\n\t\t\t\tthis.triggerMethod('click:'+this.name+':fail', error, options);\r\n\t\t\t}\r\n\t\t},\r\n\t\tgetText(){\r\n\t\t\treturn this.getOption('text');\r\n\t\t},\r\n\t\ttemplateContext(){\r\n\t\t\treturn {\r\n\t\t\t\ttext: this.getText()\r\n\t\t\t};\r\n\t\t},\r\n\t\tdisable(){\r\n\t\t\tthis.$el.prop('disabled', true);\r\n\t\t},\r\n\t\tenable(){\r\n\t\t\tthis.$el.prop('disabled', false);\r\n\t\t},\r\n\t});\r\n};\r\n","import { View } from '../config';\r\nimport buttonMixin from './mixin';\r\nexport {\r\n\tbuttonMixin\r\n};\r\nexport default buttonMixin(View);\r\n","\r\nimport _ from 'underscore';\r\nimport { clone, setByPath, getByPath, compareObjects, betterResult, takeFirst } from 'bbmn-utils';\r\n\r\nfunction getTriggerMethod(context){\r\n\tif(!context) { return () => {}; }\r\n\treturn _.isFunction(context.triggerMethod) ? context.triggerMethod\r\n\t\t: _.isFunction(context.trigger) ? context.trigger\r\n\t\t\t: () => {};\r\n}\r\n\r\nfunction ensureError(error, value){\r\n\tif(error instanceof Error){\r\n\t\tthrow error;\r\n\t}\r\n\treturn arguments.length > 1 ? value : error;\r\n}\r\n\r\n\r\nexport default Base => Base.extend({\r\n\r\n\tisControl: true,\r\n\tvalidateOnReady: false,\r\n\r\n\tconstructor(options){\t\t\r\n\t\tthis._initControl(options);\r\n\t\tBase.apply(this, arguments);\r\n\t\tif (this.getOption('validateOnReady')) {\r\n\t\t\tthis.once('control:ready', () => {\r\n\t\t\t\tthis.validate().catch(() => {});\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tthis.valueOptions = this.getOption('valueOptions') || {};\r\n\t},\r\n\r\n\r\n\r\n\t_onControlDestroy(){\r\n\t\tif (!this._isDestroing) {\r\n\t\t\tthis._isDestroing = true;\r\n\t\t}\r\n\t\tlet parent = this.getParentControl();\r\n\t\tif (parent && _.isFunction(parent._removeChildControl)) {\r\n\t\t\tparent._removeChildControl(this);\r\n\t\t}\r\n\t\tlet children = this.getChildrenControls();\r\n\t\tif (children) {\r\n\t\t\t_.each(children, child => child._removeParentControl());\r\n\t\t\tchildren.length = 0;\r\n\t\t}\r\n\t\tdelete this._cntrl;\r\n\t},\r\n\t_removeChildControl(control){\r\n\t\tthis.off(control);\r\n\t\tlet children = this.getChildrenControls();\r\n\t\tif (!children.length) { return; }\r\n\t\tlet index = children.indexOf(control);\r\n\t\tif (index === -1) return;\r\n\t\tchildren.splice(index, 1);\r\n\t},\r\n\t_addChildControl(control){\r\n\t\tlet controlName = control.getControlName();\r\n\t\tlet children = this.getChildrenControls();\r\n\t\tlet found = _.find(children, child => child.getControlName() === controlName);\r\n\t\t!found && children.push(control);\r\n\t},\r\n\t_removeParentControl(){\r\n\t\tif(_.isObject(this._cntrl))\r\n\t\t\tdelete this._cntrl.parent;\r\n\t},\r\n\r\n\r\n\r\n\t_initControl(options = {}){\r\n\t\tif (this._controlInitialized) { return; }\r\n\r\n\t\tthis._cntrl = {};\r\n\t\tlet name = takeFirst('controlName', options, this) || 'control';\r\n\t\tthis._cntrl.name = name;\r\n\r\n\t\tlet value = takeFirst('value', options, this);\r\n\t\tvalue = this._clone(value);\r\n\t\tthis.initControlValue(value);\r\n\t\tthis.initParentControl(options);\r\n\r\n\t\tthis.once('destroy', this._onControlDestroy);\r\n\r\n\t\tthis._controlInitialized = true;\r\n\t},\r\n\tinitParentControl(options){\r\n\t\tlet parent = takeFirst('proxyTo', options, this) || takeFirst('parentControl', options, this);\r\n\t\tthis.setParentControl(parent);\r\n\t},\r\n\tsetParentControl(parent){\r\n\r\n\t\tthis._cntrl.parent = parent;\r\n\t\tif (parent && _.isFunction(parent._addChildControl)) {\r\n\t\t\tparent._addChildControl(this);\r\n\t\t}\r\n\t},\r\n\tinitControlValue(value){\r\n\t\tthis._cntrl.initial = value;\r\n\t\tthis._cntrl.value = value;\r\n\t\tthis._cntrl.notValidated = value;\r\n\t},\r\n\tgetControlName(){\r\n\t\treturn this._cntrl.name;\r\n\t},\r\n\r\n\tisSameControlValue(value){\r\n\t\tlet current = this.getControlValue();\r\n\t\treturn this.isValid() && compareObjects(current, value);\r\n\t},\r\n\r\n\tgetControlValue(key, options = {}){\r\n\t\t\r\n\t\tif(_.isObject(key)) {\r\n\t\t\toptions = key;\r\n\t\t\tkey = undefined;\r\n\t\t}\r\n\t\tlet { notValidated, clone } = options;\r\n\t\tlet valueKey = notValidated ? 'notValidated' : 'value';\r\n\t\tlet value = this._cntrl[valueKey];\r\n\t\tif (key != null) {\r\n\t\t\tvalue = getByPath(value, key);\r\n\t\t} else {\r\n\t\t\tvalue = clone ? this._clone(value) : value;\r\n\t\t}\r\n\t\tif (_.isFunction(options.transform)){\r\n\t\t\tvalue = options.transform.call(this, value);\r\n\t\t}\r\n\t\treturn value;\r\n\t},\r\n\r\n\tsetControlValue(value, options = {}){\r\n\t\tlet  { key, notValidated } = options;\r\n\t\tvalue = this._prepareValueBeforeSet(value, { key });\r\n\t\tconst resolve = Promise.resolve(value);\r\n\t\tif (this.isSameControlValue(value)) { return resolve; }\r\n\r\n\t\tthis._cntrl.notValidated = value;\r\n\r\n\t\tif (notValidated) { return resolve; }\r\n\t\treturn this._setControlValue(value, options);\r\n\t},\r\n\r\n\t_prepareValueBeforeSet(value, { key } = {}){\r\n\t\tvalue = this.prepareValueBeforeSet(value);\r\n\t\tif (key == null) { return value; }\r\n\r\n\t\tlet current = this.getControlValue({ notValidated: true, clone: true }) || {};\r\n\t\tsetByPath(current, key, value);\r\n\t\treturn current;\r\n\t},\r\n\r\n\t//override this if you need to modify value before set\r\n\tprepareValueBeforeSet: value => value,\r\n\r\n\t_setControlValue(value, options = {}) {\r\n\t\tlet { skipValidation } = options;\r\n\t\tif (skipValidation) {\r\n\t\t\treturn this._onSetControlValueValidateSuccess(value, options);\r\n\t\t}\r\n\t\treturn this._validate(value, options)\r\n\t\t\t.then(\r\n\t\t\t\t() => this._onSetControlValueValidateSuccess(value, options), \r\n\t\t\t\terror => this._onSetControlValueValidateFail(error, value, options)\r\n\t\t\t);\r\n\t},\r\n\t_onSetControlValueValidateSuccess(value, options){\r\n\t\tthis._cntrl.previous = this._cntrl.value;\r\n\t\tthis._cntrl.value = value;\r\n\t\tthis._cntrl.isDone = false;\r\n\t\tthis._tryTriggerEvent('change', [value], options);\r\n\t\treturn Promise.resolve(value);\r\n\t},\r\n\r\n\t_onSetControlValueValidateFail(error, value, options){\r\n\t\tthis._tryTriggerEvent('change:fail', [value, error], options);\r\n\t\treturn ensureError(error, value);\r\n\t},\r\n\r\n\tisValid(){\r\n\t\treturn this._cntrl.isValid !== false;\r\n\t},\r\n\r\n\tvalidate(options = {}){\r\n\r\n\t\tlet notValidated = !this.isValid();\r\n\t\tlet value = this.getControlValue({ notValidated });\r\n\t\tlet promise = this._validate(value, options);\r\n\t\tlet _catch = options.catch;\r\n\r\n\t\tif (_catch === false) {\r\n\t\t\treturn promise;\r\n\t\t} else if(_.isFunction(_catch)) {\r\n\t\t\treturn promise.catch(_catch);\r\n\t\t} else {\r\n\t\t\treturn promise.catch(ensureError);\r\n\t\t}\r\n\t},\r\n\t_validate(value, options){\r\n\r\n\t\tlet validate = this._validatePromise(value, options);\r\n\r\n\t\treturn validate.then(\r\n\t\t\t() => this._onControlValidateSuccess(value, options),\r\n\t\t\terror => this._onControlValidateFail(error, value, options)\r\n\t\t);\r\n\t},\r\n\t_validatePromise(value, options){\r\n\t\t\r\n\t\tconst { skipChildValidate } = options;\r\n\t\tconst isControlWrapper = this._isControlWrapper();\r\n\r\n\t\t\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\tlet childrenErrors = {\r\n\t\t\t\tchildren: {}\r\n\t\t\t};\r\n\t\t\tlet childrenPromise = this._validateChildrenControlsPromise({ skipChildValidate, isControlWrapper }, childrenErrors);\r\n\r\n\t\t\tchildrenPromise.then(() => {\r\n\r\n\t\t\t\tif (_.size(childrenErrors.children)) {\r\n\t\t\t\t\treject(childrenErrors.children);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t} else if (childrenErrors.wrapped) {\r\n\t\t\t\t\treject(childrenErrors.wrapped);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\r\n\t\t\t\tlet promise = this._validateControlPromise(value, options);\r\n\r\n\t\t\t\tpromise.then(\r\n\t\t\t\t\t() => {\r\n\t\t\t\t\t\tresolve(value);\r\n\t\t\t\t\t},\r\n\t\t\t\t\terror => {\r\n\t\t\t\t\t\treject(error);\r\n\t\t\t\t\t}\r\n\t\t\t\t);\r\n\r\n\t\t\t});\r\n\t\t});\t\t\r\n\t},\r\n\t_validateControlPromise(value, options){\r\n\t\tlet validate = this.getOption('controlValidate', { force: false });\r\n\t\t\t\t\r\n\t\t//if there is no validation defined, resolve\r\n\t\tif (!_.isFunction(validate)) {\r\n\t\t\t\r\n\t\t\treturn Promise.resolve(value);\r\n\t\t}\r\n\r\n\t\tlet values = this.getParentControlValue({ notValidated: true });\r\n\t\tlet validateResult = validate.call(this, value, values, options);\r\n\r\n\t\tlet promise = Promise.resolve(value);\r\n\t\tif (validateResult && validateResult.then) {\r\n\t\t\tpromise = validateResult;\r\n\t\t} else if (validateResult) {\r\n\t\t\tpromise = Promise.reject(validateResult);\r\n\t\t}\r\n\t\treturn promise;\r\n\t},\r\n\t_validateChildrenControlsPromise({ isControlWrapper, skipChildValidate} = {}, errors = {}){\r\n\r\n\t\tlet children = this.getChildrenControls();\r\n\t\tlet childrenPromise = Promise.resolve();\r\n\t\tif (!children.length) return childrenPromise;\r\n\r\n\t\treturn _.reduce(children, (finaly, child) => {\r\n\t\t\tlet control = child.getControlName();\r\n\r\n\t\t\tfinaly = finaly.then(() => {\r\n\r\n\t\t\t\tif (!child.validate || (skipChildValidate && control == skipChildValidate)) {\r\n\t\t\t\t\treturn Promise.resolve();\r\n\t\t\t\t}\r\n\t\t\t\tlet validateResult = child.validate({ stopPropagation: true, catch: false });\r\n\r\n\t\t\t\treturn validateResult;\r\n\t\t\t}).catch(error => {\r\n\r\n\t\t\t\tif(isControlWrapper){\r\n\t\t\t\t\terrors.wrapped = error;\r\n\t\t\t\t} else {\r\n\t\t\t\t\terrors.children[control] = error;\r\n\t\t\t\t}\r\n\t\t\t\treturn Promise.resolve();\r\n\t\t\t});\r\n\t\t\treturn finaly;\r\n\t\t}, childrenPromise);\t\t\r\n\r\n\t},\r\n\r\n\t_onControlValidateSuccess(value, options){\r\n\t\tthis.makeValid(value, _.extend(options, { noSet: true }));\r\n\t\treturn Promise.resolve(value);\r\n\t},\r\n\tmakeValid(value, options = {}){\r\n\t\tthis._cntrl.isValid = true;\r\n\t\tif(!options.noSet && !this.isSameControlValue(value)){\r\n\t\t\tthis._setControlValue(value, { silent: true, skipValidation: true });\r\n\t\t}\r\n\t\tthis._tryTriggerEvent('valid', [value], options);\r\n\t},\r\n\t_onControlValidateFail(error, value, options){\r\n\t\tthis.makeInvalid(error, value, options);\r\n\t\treturn Promise.reject(error);\r\n\t},\r\n\tmakeInvalid(error, value, options){\r\n\t\tthis._cntrl.isValid = false;\r\n\t\tthis._tryTriggerEvent('invalid', [value, error], options);\r\n\t},\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\t_isControlWrapper()\r\n\t{\r\n\t\treturn betterResult(this.options, 'isControlWrapper', { context: this, checkAlso: this, args: [this]});\r\n\t},\r\n\tgetParentControl() {\r\n\t\tif (!this.hasParentControl()) return;\r\n\t\treturn this._cntrl.parent;\r\n\t},\r\n\thasParentControl(){\r\n\t\treturn this._cntrl && !!this._cntrl.parent;\r\n\t},\r\n\tgetParentControlValue(options) {\r\n\r\n\t\tlet parent = this.getParentControl();\r\n\t\tif (!parent || !_.isFunction(parent.getControlValue)) {\r\n\t\t\treturn this.getOption('allValues');\r\n\t\t}\r\n\t\tif (this._isControlWrapper()) {\r\n\t\t\treturn parent.getParentControlValue(options);\r\n\t\t} else {\r\n\t\t\treturn parent.getControlValue(options);\r\n\t\t}\r\n\t},\r\n\r\n\tgetChildrenControls(){\r\n\t\tif(!this._cntrl.children) {\r\n\t\t\tthis._cntrl.children = [];\r\n\t\t}\r\n\t\treturn this._cntrl.children;\r\n\t},\r\n\thandleChildControlEvent(event, controlName, ...args) {\r\n\t\tlet childEvent = controlName + ':' + event;\r\n\t\tlet trigger = getTriggerMethod(this);\r\n\r\n\t\tlet cce = this.getOption('childControlEvents', { args: [this] }) || {};\r\n\t\tlet def = this.defaultChildControlEvents || {};\r\n\t\tif(!this._debouncedChildControlEvents) {\r\n\t\t\tthis._debouncedChildControlEvents = {};\r\n\t\t}\r\n\t\tlet dcce = this._debouncedChildControlEvents;\r\n\r\n\t\tlet defHandler = def[event];\r\n\t\tlet handler = cce[childEvent];\r\n\t\tlet handlerArguments = [];\r\n\t\tlet handlerName;\r\n\t\tif (_.isFunction(handler)) {\r\n\t\t\thandlerArguments = args;\r\n\t\t\thandlerName = childEvent;\r\n\t\t} else if(_.isFunction(defHandler)){\r\n\t\t\thandlerName = '_default:' + event;\r\n\t\t\thandler = defHandler;\r\n\t\t\thandlerArguments = [controlName, ...args];\r\n\t\t} else {\r\n\t\t\tif (controlName != 'control') {\r\n\t\t\t\ttrigger.call(this, childEvent, ...args);\r\n\t\t\t}\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\tlet delay = this.getOption('debounceChildControlEvents');\r\n\t\tif(_.isNumber(delay) && delay > 0){\r\n\t\t\tif(!dcce[handlerName]){\r\n\t\t\t\tdcce[handlerName] = _.debounce(handler, delay);\r\n\t\t\t}\r\n\t\t\thandler = dcce[handlerName];\r\n\t\t}\r\n\r\n\t\tlet handlerResult = handler.apply(this, handlerArguments);\r\n\t\tif(handlerResult && handlerResult.then) {\r\n\t\t\thandlerResult.then(() => {\r\n\t\t\t\tcontrolName != 'control' && trigger.call(this, childEvent, ...args);\r\n\t\t\t});\r\n\t\t}\r\n\t\t\r\n\t},\r\n\t_getEventContext(controlName){\r\n\t\tlet isControlWraper = this._isControlWrapper();\r\n\t\tlet parent = this.getParentControl();\r\n\t\tlet control = this;\r\n\t\tlet propagateParanet = this.getOption('propagateParanet') === true;\r\n\t\tif (isControlWraper && !propagateParanet) {\r\n\t\t\tcontrolName = undefined;\r\n\t\t} else if (isControlWraper && propagateParanet && parent) {\r\n\t\t\tcontrol = parent;\r\n\t\t}\r\n\t\treturn { control, controlName, isControlWraper, parent };\r\n\t},\r\n\tdefaultChildControlEvents:{\r\n\t\t'change'(controlName, value){\r\n\t\t\t//isControlWraper && (controlName = undefined);\r\n\t\t\tlet cnt = this._getEventContext(controlName);\r\n\t\t\tcnt.control.setControlValue(value, { key: cnt.controlName, skipChildValidate: cnt.controlName });\r\n\t\t},\r\n\t\t'done'(controlName, value){\r\n\t\t\tlet cnt = this._getEventContext(controlName);\r\n\t\t\tif(cnt.control != this) return;\r\n\t\t\t// let isControlWraper = this.getOption('isControlWrapper');\r\n\t\t\t// isControlWraper && (controlName = undefined);\r\n\t\t\tlet setPromise = cnt.control.setControlValue(value, { key: cnt.controlName, skipChildValidate: cnt.controlName });\r\n\t\t\tif (cnt.isControlWraper) {\r\n\t\t\t\tsetPromise = setPromise.then(() => {\r\n\t\t\t\t\tcnt.control.controlDone();\r\n\t\t\t\t\treturn Promise.resolve();\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\treturn setPromise;\r\n\t\t},\r\n\t\t'invalid'(controlName, value, error){\r\n\t\t\tlet cnt = this._getEventContext(controlName);\r\n\r\n\t\t\t// if(this.getOption('isControlWrapper')){\r\n\t\t\t// \tcontrolName = undefined;\r\n\t\t\t// }\r\n\t\t\tcnt.control.setControlValue(value, { key: cnt.controlName, silent: true, notValidated: true });\r\n\t\t\tcnt.control.makeInvalid(error, cnt.control.getControlValue({ notValidated: true }));\r\n\t\t},\r\n\t},\r\n\r\n\tcontrolDone(){\r\n\t\tif (!this._cntrl.isValid || this._cntrl.isDone) { return; }\r\n\t\tlet value = this.getControlValue();\r\n\t\tthis._cntrl.isDone = true;\r\n\t\tthis._tryTriggerEvent('done', [value]);\r\n\t},\r\n\r\n\r\n\t/*\r\n\t\thelpers\r\n\t*/\r\n\t_clone(value){\r\n\t\tif(_.isArray(value))\r\n\t\t\treturn value.slice(0);\r\n\t\telse if(_.isObject(value)) {\r\n\t\t\treturn clone(value);\r\n\t\t} else\r\n\t\t\treturn value;\r\n\t},\r\n\t_tryTriggerEvent(name, args = [], { silent, stopPropagation } = {}){\r\n\t\tif (silent) { return; }\r\n\t\tlet controlName = this.getControlName();\r\n\t\tlet event = 'control:' + name;\r\n\t\tlet namedEvent = controlName + ':' + name;\r\n\r\n\t\tlet trigger = getTriggerMethod(this);\r\n\r\n\t\tlet parent = this.getParentControl();\r\n\t\t\r\n\t\tif (stopPropagation || !parent) { \r\n\t\t\ttrigger.call(this, event, ...args);\r\n\t\t\treturn; \r\n\t\t}\r\n\r\n\t\tif (_.isFunction(parent.handleChildControlEvent)) {\r\n\t\t\tparent.handleChildControlEvent(name, controlName, ...args);\r\n\t\t} else {\r\n\t\t\tlet parentTrigger = getTriggerMethod(parent);\r\n\t\t\tparentTrigger.call(parent, namedEvent, ...args);\r\n\t\t}\r\n\r\n\t\ttrigger.call(this, event, ...args);\r\n\t},\r\n\tmakeControlReady(){\r\n\t\tlet trigger = getTriggerMethod(this);\r\n\t\ttrigger.call(this, 'control:ready');\r\n\t},\r\n\r\n}, { ControlMixin: true });\r\n","\r\n//import { isView, isViewClass } from '../../../vendors/helpers.js';\r\nimport _ from 'underscore';\r\nimport { cssClassModifiersMixin, customsMixin } from 'bbmn-mixins';\r\nimport { buildViewByKey } from 'bbmn-utils';\r\nimport ControlMixin from '../control-mixin/index.js';\r\nimport { CollectionView, View } from 'backbone.marionette';\r\nimport { isClass } from 'bbmn-core';\r\n\r\n\r\n\r\nexport default Base => {\r\n\tif (Base == null) {\r\n\t\tBase = CollectionView;\r\n\t}\r\n\r\n\tif (!isClass(Base, CollectionView)) {\r\n\t\tthrow new Error('controlView mixin can be applied only on marionette CollectionView');\r\n\t}\r\n\r\n\tlet Mixed = Base;\r\n\r\n\tif (Mixed.ControlViewMixin) {\r\n\t\treturn Mixed;\r\n\t}\r\n\r\n\tif (!Mixed.ControlMixin) {\r\n\t\tMixed = ControlMixin(Mixed);\r\n\t}\r\n\r\n\tif (!Mixed.CssClassModifiersMixin) {\r\n\t\tMixed = cssClassModifiersMixin(Mixed);\r\n\t}\r\n\r\n\tif (!Mixed.CustomsMixin) {\r\n\t\tMixed = customsMixin(Mixed);\r\n\t}\r\n\r\n\r\n\treturn Mixed.extend({\r\n\r\n\t\trenderAllCustoms: true,\r\n\t\tisControlWrapper: true,\r\n\t\tskipFirstValidationError: true,\r\n\t\tshouldShowError: false,\r\n\t\tvalidateOnReady: false,\r\n\t\t\r\n\t\tconstructor(){\r\n\t\t\tMixed.apply(this, arguments);\r\n\t\t\tthis._setControlValidInvalidListeners();\r\n\t\t\tthis.addCssClassModifier('control-wrapper');\r\n\t\t},\r\n\r\n\t\t_setControlValidInvalidListeners(){\r\n\t\t\tif(this._controlValidInvalidListeners) { return true; }\r\n\r\n\t\t\tthis.on({\r\n\t\t\t\t'control:valid': this._onControlValid,\r\n\t\t\t\t'control:invalid': this._onControlInvalid\r\n\t\t\t});\r\n\t\t\tif(this.getOption('validateOnReady')){\r\n\t\t\t\tthis.once('customs:render', () => this.makeControlReady());\r\n\t\t\t}\t\t\t\r\n\r\n\t\t\tthis._controlValidInvalidListeners = true;\r\n\t\t},\r\n\r\n\t\tgetCustoms(){\r\n\t\t\tlet customs = [];\r\n\t\t\tif (this._isControlWrapper()) {\r\n\t\t\t\tcustoms.push(this.getControlView());\r\n\t\t\t} else {\r\n\t\t\t\tcustoms.push(...this._customs);\r\n\t\t\t}\r\n\t\t\tcustoms = this.injectSystemViews(customs);\r\n\t\t\treturn customs; \r\n\t\t\t//this._prepareCustoms(customs);\r\n\t\t},\r\n\r\n\t\t_setupCustom(view){\r\n\t\t\tthis._setupChildControl(view);\r\n\t\t\tthis.setupCustom(view);\r\n\t\t},\r\n\t\t_setupChildControl(view){\r\n\t\t\tif(_.isFunction(view.setParentControl)) {\r\n\t\t\t\tview.setParentControl(this);\r\n\t\t\t}\r\n\t\t\tthis.setupChildControl(view);\r\n\t\t},\r\n\t\tsetupChildControl: _.noop,\r\n\t\tinjectSystemViews(customs = []){\r\n\t\t\tcustoms.unshift(this.getHeaderView());\r\n\t\t\tcustoms.push(\r\n\t\t\t\tthis.getErrorView(),\r\n\t\t\t\tthis.getFooterView()\t\r\n\t\t\t);\r\n\t\t\treturn customs;\r\n\t\t},\r\n\r\n\r\n\r\n\r\n\t\tgetErrorView(){\r\n\t\t\tif (!this.getOption('shouldShowError')) { return; }\r\n\t\t\tif (this.getOption('showValidateError', {force:false})) { return; }\r\n\t\t\tthis._errorView = this.buildErrorView();\r\n\t\t\treturn this._errorView;\r\n\t\t},\r\n\t\tbuildErrorView(){\r\n\t\t\treturn buildViewByKey(this, 'errorView');\r\n\t\t},\r\n\r\n\r\n\r\n\t\tgetHeaderView(){\t\t\t\r\n\t\t\treturn this.buildHeaderView({ tagName: 'header' });\r\n\t\t},\r\n\t\tbuildHeaderView(options){\r\n\t\t\treturn this._buildNestedTextView('header', options);\r\n\t\t},\r\n\t\t_buildNestedTextView(key, options){\r\n\t\t\tlet TextView = this.getOption('TextView');\r\n\t\t\tlet buildText;\r\n\t\t\tif (!TextView) {\r\n\t\t\t\tbuildText = (text, opts) => new View(_.extend({}, opts, { template: () => text }));\r\n\t\t\t}\r\n\t\t\treturn buildViewByKey(this, key, { TextView, buildText, options });\r\n\t\t},\r\n\r\n\r\n\t\tgetFooterView(){\r\n\t\t\tif (this.getOption('buttonsInFooter')) {\r\n\t\t\t\treturn this.buildButtonsView();\r\n\t\t\t} else {\r\n\t\t\t\treturn this.buildFooterView();\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tbuildFooterView(){\r\n\t\t\treturn this._buildNestedTextView('footer', { tagName: 'footer' });\r\n\t\t},\r\n\r\n\t\tbuildButtonsView(){\r\n\t\t\tif (this._buttonsView) {\r\n\t\t\t\tthis.stopListening(this._buttonsView);\r\n\t\t\t}\r\n\r\n\t\t\tlet options = this.buildButtonsOptions();\r\n\t\t\tlet view = buildViewByKey(this, 'buttonsView', { options });\r\n\t\t\tif (!view) { return; }\r\n\r\n\t\t\tthis._buttonsView = view;\r\n\t\t\tthis.settleButtonsListeners(view);\r\n\r\n\t\t\treturn [view, Infinity];\r\n\t\t},\r\n\t\tbuildButtonsOptions(){\r\n\t\t\tlet btns = this.getOption('buttons');\r\n\t\t\tif(btns) {\r\n\t\t\t\treturn _.reduce(btns, (hash, b) => {\r\n\t\t\t\t\tlet item = this.buildButton(b, this);\r\n\t\t\t\t\thash[item.name] = item;\r\n\t\t\t\t\treturn hash;\r\n\t\t\t\t}, {});\r\n\t\t\t}\t\t\r\n\t\t},\r\n\t\tbuildButton(value){\r\n\t\t\tif (_.isString(value)) {\r\n\t\t\t\treturn this.buildButton({ text: value, className: value, name: value });\r\n\t\t\t} else if(_.isFunction(value)) {\r\n\t\t\t\treturn this.buildButton(value.call(this));\r\n\t\t\t} else if(_.isObject(value)) {\r\n\t\t\t\treturn this.fixButton(value);\r\n\t\t\t}\r\n\t\t},\r\n\t\tfixButton(button){\r\n\t\t\treturn button;\r\n\t\t},\r\n\t\tsettleButtonsListeners(buttonsView){\r\n\t\t\tthis.on({\r\n\t\t\t\t// 'control:valid': () => {\r\n\t\t\t\t// \tbuttonsView.enableButton('resolve');\r\n\t\t\t\t// },\r\n\t\t\t\t// 'control:invalid': () => {\r\n\t\t\t\t// \tbuttonsView.disableButton('resolve');\r\n\t\t\t\t// },\r\n\t\t\t\t'control:done': (value) => {\r\n\t\t\t\t\tthis._fulfill('resolve', value);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\tthis.listenTo(buttonsView, {\r\n\t\t\t\t'resolve'(){\r\n\t\t\t\t\tlet value = this.getControlValue();\r\n\t\t\t\t\tthis._fulfill('resolve', value);\r\n\t\t\t\t\t//this.triggerMethod('resolve', this.getControlValue());\r\n\t\t\t\t},\r\n\t\t\t\t'reject'(){\r\n\t\t\t\t\tthis._fulfill('reject');\r\n\t\t\t\t\t//this.triggerMethod('reject');\r\n\t\t\t\t},\r\n\t\t\t\t'reject:soft'(){\r\n\t\t\t\t\tthis._fulfill('reject:soft');\r\n\t\t\t\t\t//this.triggerMethod('reject:soft');\r\n\t\t\t\t},\r\n\t\t\t\t'reject:hard'(){\r\n\t\t\t\t\tthis._fulfill('reject:hard');\r\n\t\t\t\t\t//this.triggerMethod('reject:hard');\r\n\t\t\t\t},\r\n\t\t\t});\r\n\t\t},\r\n\t\t_fulfill(type, ...rest){\r\n\t\t\tthis.triggerMethod(type, ...rest);\r\n\t\t},\r\n\r\n\t\tgetControlView(){\r\n\t\t\tthis.control = buildViewByKey(this, 'controlView', { options: { parentControl: this, value: this.getControlValue() } });\r\n\t\t\treturn this.control;\r\n\t\t},\r\n\r\n\r\n\t\t_onControlInvalid(value, error){\r\n\t\t\tthis.disableButtons();\r\n\t\t\tthis._showValidateError(error);\r\n\t\t},\r\n\t\t_onControlValid(){\r\n\t\t\tthis.enableButtons();\r\n\t\t\tthis._hideValidateError();\r\n\t\t},\r\n\t\t\r\n\t\tdisableButtons(){\r\n\t\t\tif(this._buttonsView && _.isFunction(this._buttonsView.disableButton)) {\r\n\t\t\t\tthis._buttonsView.disableButton('resolve');\r\n\t\t\t}\r\n\t\t},\r\n\t\tenableButtons(){\r\n\t\t\tif(this._buttonsView && _.isFunction(this._buttonsView.enableButton)) {\r\n\t\t\t\tthis._buttonsView.enableButton('resolve');\r\n\t\t\t}\r\n\t\t},\r\n\t\t_showValidateError(error){\r\n\t\t\t\r\n\t\t\tlet shouldShow = this.getOption('shouldShowError');\r\n\t\t\tlet skipFirstValidationError = this.getOption('skipFirstValidationError');\r\n\r\n\t\t\tif (skipFirstValidationError && !this._firstValidationErrorSkipped) {\r\n\t\t\t\tthis._firstValidationErrorSkipped = true;\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tif (!shouldShow) return;\r\n\r\n\t\t\tlet show = this.getOption('showValidateError', { force: false });\r\n\t\t\tif (_.isFunction(show)) {\r\n\t\t\t\tshow.call(this, error);\r\n\t\t\t} else {\r\n\t\t\t\tif (!this._errorView) return;\r\n\t\t\t\tthis._errorView.showError(error);\r\n\t\t\t}\t\t\r\n\t\t},\r\n\t\t_hideValidateError(){\r\n\t\t\tlet hide = this.getOption('hideValidateError', { force: false });\r\n\t\t\tif (_.isFunction(hide)) {\r\n\t\t\t\thide.call(this);\r\n\t\t\t} else {\r\n\t\t\t\tif (!this._errorView) return;\r\n\t\t\t\tthis._errorView.hideError();\r\n\t\t\t}\t\t\r\n\t\t},\r\n\t}, { ControlViewMixin: true });\r\n\r\n\r\n};\r\n","import _ from 'underscore';\r\n\r\nimport { CollectionView, View } from 'backbone.marionette';\r\nimport { isClass } from 'bbmn-core';\r\nimport { cssClassModifiersMixin } from 'bbmn-mixins';\r\nimport buttonMixin from '../button/index.js';\r\n\r\nexport default Base => {\r\n\tif (Base == null) {\r\n\t\tBase = CollectionView;\r\n\t}\r\n\r\n\tif(!isClass(Base, CollectionView)){\r\n\t\tthrow new Error('promiseBar mixin can be applied only on CollectionView');\r\n\t}\r\n\r\n\tlet Mixed = Base;\r\n\r\n\tif (!Mixed.CssClassModifiersMixin) {\r\n\t\tMixed = cssClassModifiersMixin(Mixed);\r\n\t}\r\n\r\n\treturn Mixed.extend({\r\n\t\tconstructor(options){\r\n\t\t\tthis._buttons = {};\r\n\t\t\tBase.apply(this, arguments);\r\n\t\t\tthis.addPromiseBarCssClass();\r\n\t\t\tthis.mergeOptions(options, ['promise', 'reject', 'resolve', 'beforeRejectSoft', 'beforeRejectHard', 'beforeResolve']);\r\n\t\t},\r\n\t\ttagName: 'footer',\r\n\t\tresolve:'ok',\r\n\t\ttriggerNameEvent: true,\r\n\t\taddPromiseBarCssClass(){\r\n\t\t\tthis.addCssClassModifier('promise-bar');\r\n\t\t},\r\n\t\tonRender(){\r\n\t\t\tthis.addButtons();\r\n\t\t},\r\n\t\taddButtons(){\r\n\t\t\tlet buttons = this.buildButtons() || [];\r\n\t\t\twhile (buttons.length){\r\n\t\t\t\tlet button = buttons.pop();\r\n\t\t\t\tlet preventRender = !!buttons.length;\r\n\t\t\t\tthis.addChildView(button, { preventRender });\r\n\t\t\t}\r\n\t\t},\r\n\t\tbuildButtons(){\r\n\t\t\tlet names = ['resolve','rejectSoft','rejectHard'];\r\n\t\t\treturn _.reduce(names, (buttons, name) => {\r\n\t\t\t\tlet button = this.buildButton(name);\r\n\t\t\t\tbutton && buttons.push(button);\r\n\t\t\t\treturn buttons;\r\n\t\t\t}, []);\r\n\t\t},\r\n\t\tbuildButton(name){\r\n\t\t\tlet options = this.getButtonOptions(name);\r\n\t\t\tif (!options) return;\r\n\t\t\tlet Button = this.getOption('buttonView');\r\n\t\t\tif (!Button) {\r\n\t\t\t\tButton = this.buttonView = buttonMixin(View);\r\n\t\t\t}\r\n\t\t\tlet btn = new Button(options);\r\n\t\t\tthis._buttons[name] = btn;\r\n\t\t\treturn btn;\r\n\t\t},\r\n\t\tgetButtonOptions(name){\r\n\t\t\tlet options = this.getOption(name);\r\n\t\t\tif ( !options ) return;\r\n\t\t\tif( _.isString(options) ) {\r\n\t\t\t\toptions = { text: options };\r\n\t\t\t} else if(!_.isObject(options)) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tlet defs = { \r\n\t\t\t\tclassName: name, \r\n\t\t\t\tname, \r\n\t\t\t\ttriggerNameEvent: this.getOption('triggerNameEvent'), \r\n\t\t\t\tstopEvent: true,\r\n\t\t\t\ttext: options.text || name,\r\n\t\t\t};\r\n\t\t\toptions = _.extend(defs, options);\r\n\t\t\treturn options;\r\n\t\t},\r\n\t\tchildViewEvents:{\r\n\t\t\t'click:resolve'(data){\r\n\t\t\t\tthis.triggerMethod('resolve', data);\r\n\t\t\t},\r\n\t\t\t'click:rejectSoft'(value){ \r\n\t\t\t\tthis.triggerMethod('reject', { type: 'soft', value });\r\n\t\t\t\tthis.triggerMethod('reject:soft', value);\r\n\t\t\t},\r\n\t\t\t'click:rejectHard'(value){ \r\n\t\t\t\tthis.triggerMethod('reject', { type: 'hard', value });\r\n\t\t\t\tthis.triggerMethod('reject:hard', value);\r\n\t\t\t},\r\n\t\t\t'click:fail'(error, name, event, view) {\r\n\t\t\t\tthis.triggerMethod('click:fail', error, name, event, view);\r\n\t\t\t\tif (name) {\r\n\t\t\t\t\tthis.triggerMethod(`click:${name}:fail`, error, event, view);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tdisableButton(name){\r\n\t\t\tlet btn = this._buttons[name];\r\n\t\t\tbtn && btn.disable();\r\n\t\t},\r\n\t\tenableButton(name){\r\n\t\t\tlet btn = this._buttons[name];\r\n\t\t\tbtn && btn.enable();\r\n\t\t},\r\n\r\n\t});\r\n\r\n};\r\n","import promiseBarMixin from './mixin';\r\nimport { CollectionView } from '../config';\r\nimport Button from '../button';\r\n\r\nexport default promiseBarMixin(CollectionView).extend({\r\n\tbuttonView: Button\r\n});\r\n\r\nexport {\r\n\tpromiseBarMixin\r\n};\r\n","import _ from 'underscore';\r\nimport { View, CollectionView } from '../config';\r\nimport controlViewMixin from './mixin';\r\nimport PromiseBar from '../promise-bar';\r\n\r\nconst textView = View.extend({\r\n\ttemplate: _.template('<%= text %>'),\r\n\ttemplateContext(){\t\t\r\n\t\treturn {\r\n\t\t\ttext: this.getOption('text')\r\n\t\t};\r\n\t}\r\n});\r\n\r\nconst ControlView = controlViewMixin(CollectionView).extend({\r\n\trenderAllCustoms: true,\r\n\tbuttonsView: PromiseBar,\r\n\ttextView,\r\n\tfixButton(btn){\r\n\t\tif (btn.name != btn.text) { return btn; }\r\n\r\n\t\tif (btn.text === 'rejectSoft') {\r\n\t\t\tbtn.text = 'cancel';\r\n\t\t}\r\n\r\n\t\treturn btn;\r\n\t}\r\n});\r\nexport default ControlView;\r\nexport {\r\n\tcontrolViewMixin,\r\n\tControlView\r\n};\r\n","import _ from 'underscore';\r\n\r\nexport default {\r\n\t_createSchema(){\r\n\t\tlet schema = this.getOption('schema', { args: [ this.model, this ] });\r\n\t\tlet Schema = this.getSchemaClass();\r\n\r\n\t\tif(schema instanceof Schema){\r\n\t\t\treturn schema;\r\n\t\t}\r\n\r\n\t\t\r\n\t\tif(schema == null || _.isObject(schema)) {\r\n\t\t\treturn this.createSchema(Schema, schema);\r\n\t\t}\r\n\t\t\r\n\t},\r\n\tgetSchema(){\r\n\t\tif(this._schema) { return this._schema; }\r\n\t\t\r\n\t\tthis._schema = this._createSchema();\r\n\t\treturn this._schema;\r\n\t},\r\n\tcreateSchema(Schema, options = {}){\r\n\t\treturn new Schema(options);\r\n\t},\r\n\tgetSchemaClass(){\r\n\t\treturn this.getOption('schemaClass');\r\n\t},\r\n};\r\n","import _ from 'underscore';\r\nimport { View } from 'bbmn-components';\r\n\r\nexport default View.extend({\r\n\tclassName:'control-validate-wrapper',\r\n\tcssClassModifiers:[\r\n\t\t(m,v) => v.errorMessage ? 'error' : ''\r\n\t],\r\n\tgetTemplate(){\t\t\r\n\t\treturn () => this.errorMessage;\r\n\t},\r\n\tshowError(error){\r\n\t\tif(_.isArray(error)){\r\n\t\t\terror = error.join(', ').trim();\r\n\t\t}\r\n\t\tthis.errorMessage = error;\r\n\t\tthis.render();\r\n\t},\r\n\thideError(){\r\n\t\tthis.errorMessage = '';\r\n\t\tthis.render();\r\n\t}\r\n});\r\n","import _ from 'underscore';\r\n\r\nimport { validator, PropertySchema } from 'bbmn-components';\r\n\r\nimport { mix, buildViewByKey } from 'bbmn-utils';\r\n\r\nimport { controlViewMixin } from '../control-view/index.js';\r\nimport common from './common.js';\r\nimport { View } from 'backbone.marionette';\r\nimport errorView from './error-view';\r\n\r\nexport default Base => {\r\n\tconst Mixed = mix(Base).with(controlViewMixin, common);\r\n\r\n\treturn Mixed.extend({\r\n\t\t\r\n\t\tshouldShowError: false,\r\n\t\terrorView,\r\n\t\tclassName:'edit-model-property',\r\n\t\tschemaClass: PropertySchema,\r\n\t\tdebounceChildControlEvents: 0,\r\n\r\n\r\n\t\tgetDefaultValidateRule(options){\r\n\t\t\tlet schema = this.getSchema();\r\n\t\t\tlet rule = _.extend({}, schema.getType(options), schema.getValidation(options));\r\n\t\t\treturn rule;\r\n\t\t},\r\n\t\tgetValidateRule(options = {}){\r\n\t\t\tlet rule = this.getDefaultValidateRule(options);\r\n\t\t\treturn rule;\r\n\t\t},\r\n\t\t\r\n\t\tgetHeaderView(){\r\n\t\t\treturn this._getHeaderView();\r\n\t\t},\r\n\t\t_getHeaderView(){\r\n\t\t\tlet TextView = this.getOption('textView');\r\n\t\t\tlet buildText;\r\n\t\t\tif (!TextView) {\r\n\t\t\t\tbuildText = (text, opts) => new View(_.extend({}, opts, { template: () => text }));\r\n\t\t\t}\r\n\t\t\tlet view = buildViewByKey(this, 'header', { TextView, buildText, options: { tagName: 'header' } });\r\n\t\t\tif(view) { return view; }\r\n\r\n\t\t\tif(this.getOption('propertyLabelAsHeader')) {\r\n\t\t\t\tlet label = this.getSchema().getLabel();\r\n\t\t\t\tif(TextView) {\r\n\t\t\t\t\treturn new TextView({ text: label, tagName: 'header'});\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn new View({ template: () => label, tagName: 'header'});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tgetSchemaOptions(opts){\r\n\t\t\tlet options = {\r\n\t\t\t\tvalue: this.getControlValue(),\r\n\t\t\t\tallValues: this.getParentControlValue(),\r\n\t\t\t\tmodel: this.model\t\t\t\r\n\t\t\t};\r\n\t\t\treturn _.extend(options, opts);\r\n\t\t},\r\n\t\tgetControlView(){\r\n\t\t\tlet options = this.getSchemaOptions();\r\n\t\t\tlet editOptions = this.getSchema().getEdit(options);\r\n\t\t\treturn this.buildPropertyView(editOptions);\r\n\t\t},\r\n\t\tcontrolValidate(value, allValues){\r\n\t\t\tlet rule = this.getValidateRule({ value, allValues });\r\n\t\t\tif(!rule || !_.size(rule)) return;\r\n\t\t\treturn validator.validate(value, rule, { allValues });\r\n\t\t},\r\n\t\t\r\n\t\t// must be overrided\r\n\t\t// accepts:\toptions arguments.\r\n\t\t// returns:\tshould return Control instance\r\n\t\tbuildPropertyView(){\r\n\t\t\tthrow new Error('buildPropertyView not implemented. You should build view by your own');\r\n\t\t},\r\n\r\n\t});\r\n};\r\n","import _ from 'underscore';\r\nimport { controlViewMixin } from '../control-view/index.js';\r\nimport common from './common.js';\r\nimport { mix } from 'bbmn-utils';\r\nimport EditProperty from './property.js';\r\n\r\nimport { ModelSchema } from 'bbmn-components';\r\n\r\nimport propertyErrorView from './error-view';\r\n\r\nexport default Base => {\r\n\tlet Mixed = mix(Base).with(controlViewMixin, common);\r\n\r\n\treturn Mixed.extend({\r\n\r\n\t\tshouldShowError: false,\r\n\t\tshouldShowPropertyError: true,\r\n\t\tpropertyErrorView,\r\n\t\tvalidateOnReady: true,\r\n\t\tbuttonsInFooter: true,\r\n\t\tisControlWrapper: false,\r\n\t\tschemaClass: ModelSchema,\r\n\t\teditPropertyClass: EditProperty,\r\n\r\n\t\tpropertyLabelAsHeader: true,\r\n\r\n\t\tclassName:'edit-model-control',\r\n\r\n\t\tgetCustoms(){\r\n\t\t\tlet customs = [];\r\n\t\t\tcustoms.push(...this.getPropertiesViews());\r\n\t\t\tcustoms.push(...this._customs);\r\n\t\t\tcustoms = this.injectSystemViews(customs);\r\n\t\t\treturn customs;\r\n\t\t},\r\n\t\tgetPropertiesViews(){\r\n\t\t\tlet modelSchema = this.getSchema();\r\n\t\t\tlet propertiesToShow = this.getOption('propertiesToShow', { args: [ this.model, this ]}) || [];\r\n\t\t\tif(!propertiesToShow.length) {\r\n\t\t\t\tpropertiesToShow = modelSchema.getPropertiesNames();\r\n\t\t\t}\r\n\t\t\treturn _.map(propertiesToShow, name => this._createEditProperty(name, modelSchema));\r\n\t\t},\r\n\t\t_createEditProperty(name, modelSchema){\r\n\t\t\tlet schema = modelSchema.getProperty(name, { create: true });\r\n\t\t\tlet EditProperty = this.getEditPropertyClass();\r\n\t\t\tconst def = {\r\n\t\t\t\tcontrolName: name,\r\n\t\t\t\tschema,\r\n\t\t\t\tvalue: this.getPropertyValue(name),\r\n\t\t\t\tallValues: this.getControlValue({ notValidated: true }),\r\n\t\t\t\tpropertyLabelAsHeader: this.getOption('propertyLabelAsHeader')\r\n\t\t\t};\r\n\t\t\tif(this.getOption('shouldShowPropertyError')) {\r\n\t\t\t\tdef.shouldShowError = true;\r\n\t\t\t\tdef.errorView = this.getOption('propertyErrorView');\r\n\t\t\t}\r\n\t\t\tlet options = this.getEditPropertyOptions(def);\r\n\t\t\treturn this.createEditProperty(EditProperty, options);\r\n\t\t},\r\n\t\tgetPropertyValue(property){\r\n\t\t\treturn this.getControlValue(property);\r\n\t\t},\r\n\t\tgetEditPropertyClass(){\r\n\t\t\treturn this.getOption('editPropertyClass');\r\n\t\t},\r\n\t\tgetEditPropertyOptions(defaultOptions){\r\n\t\t\treturn _.extend({}, defaultOptions, this.getOption('editPropertyOptions'));\r\n\t\t},\r\n\t\tcreateEditProperty(EditProperty, options){\r\n\t\t\treturn new EditProperty(options);\r\n\t\t},\r\n\r\n\t});\r\n};\r\n","import _ from 'underscore';\r\n//import { isClass } from 'bbmn-core';\r\nimport { PropertySchema } from 'bbmn-components';\r\n\r\nconst controls = {\r\n\r\n};\r\n\r\nfunction guesControl(arg) {\r\n\tif(!_.isObject(arg)) {\r\n\t\treturn;\r\n\t}\r\n\tlet control = getControlByName(arg.control);\r\n\r\n\tif(!control){\r\n\t\tcontrol = getControlByName(arg.type);\r\n\t}\r\n\r\n\tif (!control && !!arg.sourceValues) {\r\n\t\tcontrol = getControlByName('select');\r\n\t}\r\n\r\n\treturn control;\r\n}\r\n\r\nfunction getControlByName(name){\r\n\treturn controls[name];\r\n}\r\n\r\nfunction getControlBySchema(schema, opts = {}){\r\n\tlet value = schema.getType(opts);\r\n\tlet control = getControlByName(value.control);\r\n\tif (!control && value.modelType == 'range' && !opts.noRange) {\r\n\t\tcontrol = getControlByName('range:' + value.type);\r\n\t\tif(!control){\r\n\t\t\tcontrol = getControlByName('range');\r\n\t\t}\r\n\t}\r\n\tif (!control && !!value.sourceValues) {\r\n\t\tcontrol = getControlByName('select');\r\n\t}\r\n\tif (!control) {\r\n\t\tcontrol = getControlByName(value.type);\r\n\t}\r\n\treturn control;\r\n}\r\n\r\nfunction getControl(arg, opts){\r\n\tlet control;\r\n\tif(_.isString(arg)){\r\n\t\tcontrol = getControlByName(arg, opts);\r\n\t} else if(arg instanceof PropertySchema) {\r\n\t\tcontrol = getControlBySchema(arg, opts);\r\n\t} else {\r\n\t\tcontrol = guesControl(arg, opts);\r\n\t}\r\n\treturn control || controls.default;\r\n}\r\n\r\nfunction defineControl(name, Control){\r\n\tif(!_.isString(name)) {\r\n\t\tthrow new Error('name must be a string');\r\n\t}\r\n\tcontrols[name] = Control;\r\n}\r\n\r\n\r\n\r\nexport {\r\n\tdefineControl,\r\n\tgetControl,\r\n\tcontrols,\r\n};\r\n","import editPropertyMixin from './property.js';\r\nimport editModelMixin from './model.js';\r\nimport { mix } from 'bbmn-utils';\r\nimport ControlView from '../control-view';\r\nimport { getControl } from '../controls';\r\nimport SchemaErrorView from './error-view';\r\n\r\nconst BaseEditProperty = mix(ControlView).with(editPropertyMixin);\r\n\r\nconst EditProperty = BaseEditProperty.extend({\r\n\tgetEditControl(){\r\n\t\treturn getControl(this.getSchema(), this.getSchemaOptions());\r\n\t},\r\n\tgetEditControlOptions(editOptions){\r\n\t\treturn editOptions;\r\n\t},\r\n\tbuildPropertyView(editOptions){\r\n\t\tlet Control = this.getEditControl();\r\n\t\tlet options = this.getEditControlOptions(editOptions);\r\n\t\treturn new Control(options);\r\n\t},\r\n});\r\n\r\nconst EditModel = mix(ControlView).with(editModelMixin).extend({\r\n\teditPropertyClass: EditProperty\r\n});\r\n\r\nexport {\r\n\teditPropertyMixin,\r\n\teditModelMixin,\r\n\tEditProperty,\r\n\tEditModel,\r\n\tSchemaErrorView\r\n};\r\n","import _ from 'underscore';\r\nimport { getOption } from 'bbmn-utils';\r\nconst _getOption = (context, key, checkAlso) => getOption(context, key, { args:[context], checkAlso });\r\n\r\nexport default function getInputType(inputView, opts = {}){\r\n\t\r\n\tlet valueType = _getOption(inputView, 'valueType', opts);\r\n\t\r\n\tif(opts.valueOptions && opts.valueOptions.type) {\r\n\t\tvalueType = opts.valueOptions.type;\r\n\t}\r\n\r\n\tif (valueType == null) {\r\n\t\tlet value = inputView.getControlValue();\r\n\t\tif ( value == null) {\r\n\t\t\tvalueType = 'string';\r\n\t\t} else {\r\n\t\t\tif(_.isNumber(value))\r\n\t\t\t\tvalueType = 'number';\r\n\t\t\telse if(_.isDate(value))\r\n\t\t\t\tvalueType = 'datetime';\r\n\t\t\telse\r\n\t\t\t\tvalueType = 'string';\r\n\t\t}\t\t\r\n\t}\r\n\r\n\tif (valueType == 'number') {\r\n\t\tinputView._valueIsNumber = true;\r\n\t}\r\n\r\n\tlet type = _getOption(inputView, 'inputType', opts);\r\n\tif(type == null){\r\n\t\ttype = _getOption(inputView.valueOptions, 'inputType', opts.valueOptions);\r\n\t}\r\n\tif (!type) {\r\n\t\tif (inputView._valueIsNumber) {\r\n\t\t\ttype = _getOption(inputView, 'inputNumberType', opts) || 'number';\r\n\t\t} else if (valueType == 'string') {\r\n\t\t\ttype = 'text';\r\n\t\t} else if (valueType == 'datetime') {\r\n\t\t\ttype = 'datetime';\r\n\t\t} else {\r\n\t\t\ttype = 'text';\r\n\t\t}\r\n\t}\r\n\tinputView.inputType = type;\r\n\tinputView.valueType = valueType;\r\n\treturn type;\r\n}\r\n","import _ from 'underscore';\r\nimport getInputType from './get-input-type.js';\r\n\r\nimport { getOption } from 'bbmn-utils';\r\n\r\nfunction fixAttributes(attrs, view, opts)\r\n{\r\n\tlet tagName = getOption(view, opts, 'tagName');\r\n\tif(['select', 'textarea'].indexOf(tagName) > -1) {\r\n\t\tdelete attrs.value;\r\n\t\tdelete attrs.type;\r\n\t}\r\n\treturn attrs;\r\n}\r\n\r\nexport default function setInputAttributes(inputView, opts = {}) {\r\n\r\n\tlet attributes = getOption(inputView, opts, 'attributes');\r\n\r\n\tlet check = _.extend({}, inputView, opts, inputView.valueOptions, opts.valueOptions);\r\n\r\n\tlet restrictionKeys = {\r\n\t\t'maxLength':'maxlength', \r\n\t\t'minLength':'minlength',\r\n\t\t'minValue':'min', \r\n\t\t'maxValue':'max', \r\n\t\t'valuePattern':'pattern',\r\n\t\t'required':'required',\r\n\t\t'value':'value'\r\n\t};\r\n\r\n\tlet restrictions = {};\r\n\t_(restrictionKeys).each((key2, key) => {\r\n\t\tlet value = check[key];\r\n\t\tif (value != null)\r\n\t\t\trestrictions[key2] = value;\r\n\t});\r\n\r\n\tlet newattributes = _.extend({\r\n\t\tvalue: inputView.value,\r\n\t\ttype: getInputType(inputView, opts),\r\n\t}, restrictions, attributes);\r\n\t\r\n\tinputView.attributes = fixAttributes(newattributes, inputView, opts);\r\n\r\n\tif(opts.attributes)\r\n\t\tdelete opts.attributes;\r\n}\r\n","import { getOption } from 'bbmn-utils';\r\nexport default (context, key, ifNull) => getOption(context, key, { args:[context], default: ifNull });\r\n\r\n","export default function isChar(event){\r\n\treturn event.key && event.key.length == 1 && !event.ctrlKey;\r\n}","import getOption from './_get-option.js';\r\nimport isChar from './_is-char.js';\r\nexport default function(eventContext) {\r\n\tlet { context, event } = eventContext;\r\n\r\n\tif (context.triggerMethod('keydown', event) === false) { return; }\r\n\r\n\r\n\tlet prevent = false;\r\n\tlet stop = false;\r\n\r\n\tif (isChar(event)) {\r\n\t\tif (!context.isEnteredCharValid(event.key)) {\r\n\t\t\tprevent = true;\r\n\t\t}\r\n\t}\r\n\tif(event.keyCode == 13 && getOption(context, 'doneOnEnter', true)){\r\n\t\tprevent = true;\r\n\t\tstop = true;\r\n\t}\r\n\r\n\tstop && event.stopPropagation();\r\n\tprevent && event.preventDefault();\r\n}\r\n","import getOption from './_get-option.js';\r\nexport default function(eventContext) {\r\n\tlet { context, event } = eventContext;\r\n\r\n\tif (context.triggerMethod('keyup', event) === false) { return; }\r\n\r\n\tif (event.keyCode == 13) {\r\n\t\t\r\n\t\tlet shouldDone = getOption(context, 'doneOnEnter', true);\r\n\t\tif (shouldDone) {\r\n\r\n\t\t\tevent.stopPropagation();\r\n\t\t\tevent.preventDefault();\r\n\t\t\tcontext.controlDone();\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\r\n}\r\n","export default function(eventContext) {\r\n\tlet { context, event } = eventContext;\r\n\r\n\t\r\n\tif (context.triggerMethod('paste', event) === false) { return; }\r\n\r\n\r\n\tlet text = event.originalEvent.clipboardData.getData('text/plain');\r\n\tif (!text) return;\r\n\tif (!context.isValueValid(text)) {\r\n\t\tevent.preventDefault();\r\n\t\tevent.stopPropagation();\r\n\t}\r\n}\r\n","import getOption from './_get-option.js';\r\nexport default function(eventContext) {\r\n\tlet { context, event } = eventContext;\r\n\r\n\tif (context.triggerMethod('blur', event) === false) { return; }\r\n\r\n\r\n\tif (getOption(context, 'doneOnBlur', true)) {\r\n\t\tcontext.controlDone();\r\n\t}\r\n}\r\n","import getOption from './_get-option.js';\r\nexport default function(eventContext) {\r\n\tlet { context, input, event } = eventContext;\r\n\r\n\tif (context.triggerMethod('focus', event) === false) { return; }\r\n\r\n\tif (getOption(context, 'selectOnFocus', true)) {\r\n\t\tinput.select();\r\n\t}\r\n}\r\n","export default function(eventContext) {\r\n\r\n\tlet { context, input, event } = eventContext;\r\n\r\n\tif (context.triggerMethod('input', event) === false) { return; }\r\n\r\n\r\n\tcontext.setControlValue(event.target.value).then(newvalue => {\r\n\t\tif (event.target.value != (newvalue || '').toString()) {\r\n\t\t\tinput.value = newvalue;\r\n\t\t}\r\n\t});\r\n\r\n}\r\n","import keydown from './keydown.js';\r\nimport keyup from './keyup.js';\r\nimport paste from './paste.js';\r\nimport blur from './blur.js';\r\nimport focus from './focus.js';\r\nimport input from './input.js';\r\n\r\nexport default {\r\n\tkeydown, \r\n\t//keypress,\r\n\tkeyup,\r\n\tpaste,\r\n\tblur,\r\n\tfocus,\r\n\tinput,\r\n\t//'js:change': jsChange\r\n};\r\n","import _ from 'underscore';\r\nimport { camelCase } from 'bbmn-utils';\r\nimport events from './events/index.js';\r\nexport default function handleInputEvent(control, eventName, event) {\r\n\tlet options = _.extend({\r\n\t\tcontext: control,\r\n\t\tinput: control.el,\r\n\t\trestrictions: control.restrictions,\r\n\t\teventName,\r\n\t\tevent\r\n\t});\r\n\r\n\r\n\tlet method = camelCase(`on:dom:${eventName}`);\r\n\r\n\tif (_.isFunction(events[eventName])) {\r\n\t\tevents[eventName].call(control, options);\r\n\t} \r\n\t\r\n\tif (_.isFunction(control[method])) {\r\n\t\tcontrol[method](event, options);\r\n\t} \r\n}\r\n","import _ from 'underscore';\r\nimport handleEvent from './handle-event.js';\r\nimport eventHandlers from './events/index.js';\r\nimport { getOption } from 'bbmn-utils';\r\n\r\n\r\nconst _getOption = (context, key, checkAlso) => \r\n\tgetOption(context, key, { args:[context], checkAlso });\r\n\r\nexport default function setInputEvents(inputView, opts = {}) {\r\n\r\n\tlet passedEvents = _getOption(inputView, 'events', opts);\t\r\n\r\n\tlet eventsArray = _(eventHandlers).keys();\t\r\n\tlet events = _.reduce(eventsArray, (Memo, eventName) => {\r\n\t\tMemo[eventName] = function(event){ \r\n\t\t\thandleEvent(this, eventName, event); \r\n\t\t};\r\n\t\treturn Memo;\r\n\t}, {});\r\n\tinputView.events = _.extend(events, passedEvents);\r\n}\r\n","import _ from 'underscore';\r\nimport { convertString as convert, getOption } from 'bbmn-utils';\r\n\r\nimport ControlMixin from '../control-mixin/index.js';\r\nimport setInputAttributes from './set-attributes.js';\r\nimport setInputEvents from './set-events.js';\r\n\r\n//import { convertString as convert, getOption } from '../../../utils/index.js';\r\nexport default Base => {\r\n\tlet Mixin = Base.ControlMixin ? Base : ControlMixin(Base);\r\n\treturn Mixin.extend({\r\n\t\tconstructor(opts){\r\n\t\t\t\r\n\t\t\tthis._initControl(opts);\r\n\r\n\t\t\tsetInputAttributes(this, opts);\r\n\t\t\tsetInputEvents(this, opts);\r\n\t\t\tMixin.apply(this, arguments);\r\n\r\n\t\t\tif (!_.isFunction(this.getOption)) {\r\n\t\t\t\tthis.getOption = (...args) => getOption(this, ...args);\r\n\t\t\t}\r\n\r\n\t\t\tthis.buildRestrictions();\r\n\t\t\tlet value = this.getOption('value');\r\n\t\t\tvalue == null && (value = '');\r\n\t\t\tthis.el.value = value;\r\n\t\t\t//this.setControlValue(value, { trigger: false, silent: true });\r\n\t\t},\r\n\t\ttagName:'input',\r\n\t\ttemplate: false,\r\n\t\tdoneOnEnter: true,\r\n\t\tdoneOnBlur: true,\r\n\t\tbuildRestrictions(){\r\n\t\t\tlet attrs = _.result(this, 'attributes');\r\n\t\t\tlet pickNumbers = ['maxlength', 'minlength', 'min', 'max'];\r\n\t\t\tlet pickStrings = ['pattern'];\r\n\t\t\tlet pickBools = ['required'];\r\n\t\t\tlet restrictions = {};\r\n\t\t\t_(attrs).each((value, key) => {\r\n\t\t\t\tlet pick = false;\r\n\t\t\t\tkey = key.toLowerCase();\r\n\t\t\t\tif (pickNumbers.indexOf(key) > -1) {\r\n\t\t\t\t\tvalue = convert(value, 'number');\r\n\t\t\t\t\tpick = true;\r\n\t\t\t\t} else if (pickStrings.indexOf(key) > -1) {\r\n\t\t\t\t\tpick = true;\r\n\t\t\t\t} else if (pickBools.indexOf(key) > -1) {\r\n\t\t\t\t\tpick = true;\r\n\t\t\t\t\tvalue = convert(value, 'boolean', { returnNullAndEmptyAs: true, returnOtherAs: true });\r\n\t\t\t\t}\r\n\t\t\t\tpick && (restrictions[key] = value);\r\n\t\t\t});\r\n\t\t\tthis.restrictions = restrictions;\t\t\r\n\t\t},\r\n\t\tprepareValueBeforeSet(value){\r\n\t\t\tif (value == null || value === '') return value;\r\n\t\t\t\r\n\t\t\tlet len = this.getMaxLength();\r\n\t\t\tif (len > 0) {\r\n\t\t\t\tvalue = value.toString().substring(0, len);\r\n\t\t\t}\r\n\t\t\tif (this._valueIsNumber) {\r\n\t\t\t\tlet num = convert(value, 'number');\r\n\t\t\t\tif(isNaN(num))\r\n\t\t\t\t\treturn;\r\n\t\t\t\tlet min = this.restrictions.min;\r\n\t\t\t\tlet max = this.restrictions.max;\r\n\t\t\t\t!isNaN(min) && num < min && (num = min);\r\n\t\t\t\t!isNaN(max) && num > max && (num = max);\r\n\t\t\t\treturn num;\r\n\t\t\t}\r\n\t\t\treturn value;\r\n\t\t},\r\n\t\tgetValueType(){\r\n\t\t\treturn this.valueType;\r\n\t\t},\r\n\t\tconvertValue(value){\r\n\t\t\treturn convert(value, this.getValueType());\r\n\t\t},\t\t\r\n\t\tgetMaxLength()\r\n\t\t{\r\n\t\t\treturn this.restrictions.maxlength;\r\n\r\n\t\t},\r\n\t\tisLengthValid(){\r\n\t\t\tlet value = this.getControlValue();\r\n\t\t\tlet len = this.getMaxLength();\r\n\t\t\treturn len == null || value.length < len;\r\n\t\t},\r\n\t\tisEnteredCharValid(char) {\r\n\t\t\tlet type = this.getValueType();\r\n\r\n\t\t\tif (type == 'number') {\r\n\t\t\t\treturn ['.','-'].indexOf(char) > -1 || !isNaN(parseInt(char, 10));\r\n\t\t\t} else {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t},\r\n\t\tisValueValid(value){\r\n\t\t\tlet type = this.getValueType();\r\n\t\t\tif (type == 'number') {\r\n\t\t\t\treturn !isNaN(parseFloat(value, 10));\r\n\t\t\t} else {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t},\r\n\t\tcontrolValidate(value){\r\n\t\t\tif (value == null || value === '') {\r\n\t\t\t\tif(this.restrictions.required)\r\n\t\t\t\t\treturn 'required';\r\n\t\t\t\telse if (this.restrictions.minLength > 0) {\r\n\t\t\t\t\treturn 'length:small';\r\n\t\t\t\t}\r\n\t\t\t\telse\r\n\t\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tlet strValue = value.toString();\r\n\t\t\tif (_.isNumber(this.restrictions.maxlength) && strValue.length > this.restrictions.maxlength)\r\n\t\t\t\treturn 'length:big';\r\n\t\t\tif (this._valueIsNumber) {\r\n\t\t\t\tif (!_.isNumber(value))\r\n\t\t\t\t\treturn 'not:number';\r\n\t\t\t\tif (_.isNumber(this.restrictions.min) && value < this.restrictions.min)\r\n\t\t\t\t\treturn 'less:than:min';\r\n\t\t\t\tif (_.isNumber(this.restrictions.max) && value > this.restrictions.max)\r\n\t\t\t\t\treturn 'greater:than:max';\r\n\t\t\t}\r\n\t\t\tif (this.restrictions.pattern) {\r\n\t\t\t\tlet pattern = RegExp(this.restrictions.pattern);\r\n\t\t\t\tif (pattern.test(strValue)) {\r\n\t\t\t\t\treturn 'pattern:mismatch';\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n};\r\n","import { View } from '../config';\r\nimport inputMixin from './mixin';\r\n\r\nimport { defineControl } from '../controls';\r\nconst InputControl = inputMixin(View);\r\n\r\ndefineControl('default', InputControl);\r\ndefineControl('text', InputControl);\r\ndefineControl('number', InputControl);\r\n\r\nexport default InputControl;\r\nexport {\r\n\tinputMixin\r\n};\r\n","import _ from 'underscore';\r\n\r\nimport { View } from '../config';\r\nimport Control from '../control-view';\r\nimport { camelCase } from 'bbmn-utils';\r\nimport { inputMixin } from '../input';\r\nimport { defineControl } from '../controls';\r\n\r\nconst TextArea = inputMixin(View).extend({\r\n\tdoneOnEnter: false,\r\n\ttagName:'textarea',\r\n\ttemplate: data => data.value,\r\n\ttemplateContext(){\r\n\t\treturn {\r\n\t\t\tvalue: this.getControlValue()\r\n\t\t};\r\n\t}\r\n});\r\n\r\n\r\nconst inputEvents = ['focus','blur','input','keyup','keydown'];\r\n\r\nconst TextAreaControl = Control.extend({\r\n\t\r\n\tconstructor(){\r\n\t\tControl.apply(this, arguments);\r\n\t\tthis.addCssClassModifier('control-textarea');\r\n\t},\r\n\tcontrolView: TextArea,\r\n\tcontrolViewOptions(){\r\n\t\tlet attributes = this.getOption('inputAttributes');\r\n\r\n\t\tlet options = {\r\n\t\t\tvalueOptions: this.getOption('valueOptions'),\t\t\t\r\n\t\t};\r\n\t\tif (attributes) {\r\n\t\t\toptions.attributes = attributes;\t\t\t\r\n\t\t}\r\n\t\treturn _.extend(options, this._delegateInputEvents());\r\n\t},\r\n\t_delegateInputEvents(){\r\n\t\tlet delegatedHandlers = {};\r\n\t\t_.each(inputEvents, name => {\r\n\t\t\tlet handlerName = camelCase('on', name);\r\n\t\t\tlet handler = this.getOption(handlerName, { force: false });\r\n\t\t\tif(_.isFunction(handler)) {\r\n\t\t\t\tdelegatedHandlers[handlerName] = (...args) => {\r\n\t\t\t\t\treturn this.triggerMethod(name, ...args);\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn delegatedHandlers;\r\n\t}\r\n});\r\n\r\ndefineControl('textarea:simple', TextArea);\r\ndefineControl('bigtext', TextAreaControl);\r\ndefineControl('textarea', TextAreaControl);\r\n\r\nexport default TextAreaControl;\r\n\r\n\r\n","import _ from 'underscore';\r\nexport const common = {\r\n\tisSelected(){\r\n\t\tlet selector = this.getOption('selector');\r\n\t\treturn selector && selector.isSelected(this.model);\r\n\t},\r\n\tgetText(){\r\n\t\tlet text = this.getOption('text', { args: [this.model, this] });\r\n\t\tif (!text) {\r\n\t\t\ttext = _.isFunction(this.model.getLabel) && this.model.getLabel() || undefined;\r\n\t\t}\r\n\t\tif (!text) {\r\n\t\t\ttext = this.model.get('value');\r\n\t\t}\r\n\t\tif (!text) {\r\n\t\t\ttext = this.model.id;\r\n\t\t}\r\n\t\treturn text;\r\n\t},\r\n\ttriggerSelect(event){\r\n\t\tthis.triggerMethod('toggle:select', this, event);\r\n\t},\r\n\r\n\t_addSelectCssModifiers(){\r\n\t\tthis.addCssClassModifier('select-item');\r\n\t\tthis.addCssClassModifier((m,v) => v.isSelected() ? 'selected':'');\r\n\t},\r\n};\r\nexport default Base => Base.extend({\r\n\tconstructor(){\r\n\t\tBase.apply(this, arguments);\r\n\t\tcommon._addSelectCssModifiers.call(this);\r\n\t},\t\r\n\tisSelected: common.isSelected,\r\n\ttriggerSelect: common.triggerSelect,\r\n}, { SelectableViewMixin: true });\r\n","import _ from 'underscore';\r\nimport mixin, { common } from './selectable-view-mixin';\r\nimport { View } from 'bbmn-components';\r\nimport { mix } from 'bbmn-utils';\r\n\r\nexport default mix(View).with(mixin).extend({\r\n\trenderOnModelChange: true,\r\n\ttemplate:_.template('<i></i><span><%= text %></span><i></i>'),\r\n\ttemplateContext(){\r\n\t\treturn {\r\n\t\t\ttext: this.getText()\r\n\t\t};\r\n\t},\r\n\ttriggers:{\r\n\t\t'click':'toggle:select'\r\n\t},\r\n\t// events:{\r\n\t// \t'click'(event){\r\n\t// \t\tevent.stopPropagation();\r\n\t// \t\tthis.triggerMethod('toggle:select', this, event);\r\n\t// \t}\r\n\t// },\r\n\t// triggers: {\r\n\t// \t'click':{name:'toggle:select', stopPropagation: true}\r\n\t// },\r\n\tgetText: common.getText\r\n});\r\n","import _ from 'underscore';\r\nimport { ControlView } from '../control-view';\r\nimport { Selector, initSelectorMixin } from 'bbmn-components';\r\nimport { isCollectionClass, convertString, toBool } from 'bbmn-utils';\r\nimport DefaultChildView from './childview';\r\n//import fixChildView from './fix-childview';\r\nimport { defineControl } from '../controls';\r\n//import { Collection } from 'bbmn-core';\r\nconst BaseSelectControl = initSelectorMixin(ControlView);\r\nconst SelectControl = BaseSelectControl.extend({\r\n\tclassName: 'regular-select',\r\n\trenderCollection: true,\r\n\tdoneOnSelect: true,\r\n\tcssClassModifiers:[\r\n\t\t'select-control',\r\n\t\t(m,v) => v.isMultiple() ? 'multiple' : '',\r\n\t],\t\r\n\tconstructor(){\r\n\t\tBaseSelectControl.apply(this, arguments);\r\n\t\tthis.collection = this.selector.getCollection();\r\n\t},\r\n\tchildView: DefaultChildView,\r\n\tgetSelector(){\r\n\t\tif(!this.selector) {\r\n\t\t\tlet selectorOptions = this._getSelectorOptions();\r\n\t\t\tthis.selector = new Selector(selectorOptions);\r\n\t\t}\r\n\t\treturn this.selector;\r\n\t},\r\n\r\n\tonSelectorChange(){\r\n\t\tlet setPromise = this.setControlValue(this.selector.getValue());\r\n\t\tif (!this.isMultiple() && this.getOption('doneOnSelect')) {\r\n\t\t\tsetPromise.then(() => {\r\n\t\t\t\tthis.controlDone();\r\n\t\t\t});\r\n\t\t}\t\r\n\t},\r\n\t_getSelectorOptions(){\r\n\t\tlet source = this.getSource();\r\n\t\t\r\n\t\tlet type = this.valueOptions.type;\r\n\t\tlet extractValue = this.getOption('extractValue', { force: false});\r\n\t\tif (type == 'boolean') {\r\n\t\t\tsource = _.map(source, (value, ind) => ({id: toBool(ind), value }));\r\n\t\t\t!extractValue && (extractValue = model => model.id);\r\n\t\t}\r\n\t\tlet value = this.getControlValue();\r\n\t\tif (this.isMultiple() && type === 'enum' && _.isString(value)) {\r\n\t\t\tvalue = value.split(/\\s*,\\s*/g);\r\n\t\t}\r\n\t\tlet opts = {\r\n\t\t\tvalue,\r\n\t\t\tsource,\r\n\t\t\tmultiple: this.isMultiple(),\r\n\t\t};\r\n\t\tif(extractValue) {\r\n\t\t\topts.extractValue = extractValue;\r\n\t\t}\r\n\r\n\t\treturn opts;\r\n\t},\r\n\r\n\tsetFilter(filter){\r\n\t\tthis.selector.setSourceFilter(filter);\r\n\t},\r\n\tisMultiple(){\r\n\t\treturn this.valueOptions.multiple === true;\r\n\t},\r\n\tprepareValueBeforeSet(value){\r\n\t\tlet type = this.valueOptions.type;\r\n\t\tif (type == 'text') {\r\n\t\t\treturn value != null ? value.toString() : value;\r\n\t\t} else if (type == 'boolean') {\r\n\t\t\treturn toBool(value);\r\n\t\t} else if(_.isString(value)){\r\n\t\t\treturn convertString(value, this.valueOptions.type);\r\n\t\t} else if(_.isArray(value)) {\r\n\t\t\tif(this.valueOptions.type == 'enum') {\r\n\t\t\t\treturn value.join(', ');\r\n\t\t\t} else {\r\n\t\t\t\treturn _.map(value, val => convertString(val, this.valueOptions.type));\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\treturn value;\r\n\t\t}\r\n\t},\r\n\tgetSource(){\r\n\t\tlet src = this.valueOptions.sourceValues;\r\n\t\tif(_.isFunction(src)){\r\n\t\t\tsrc = src();\r\n\t\t}\r\n\t\treturn src;\r\n\t},\r\n});\r\n\r\ndefineControl('select', SelectControl);\r\n\r\nexport default SelectControl;\r\n","import _ from 'underscore';\r\nimport { ControlView } from '../control-view';\r\nimport { toBool, isEmptyValue } from 'bbmn-utils';\r\nexport default ControlView.extend({\r\n\ttemplate:_.template('<i></i><small></small>'),\r\n\tconstructor(){\r\n\t\tControlView.apply(this, arguments);\r\n\t\tthis.addCssClassModifier((m,v) => v.getState());\r\n\t\tthis.addCssClassModifier('boolean-switch');\r\n\t\tthis._initClickHandler();\r\n\t\tthis.on('control:change', this.refreshStateLabel);\r\n\t\tthis.refreshStateLabel();\r\n\t},\r\n\tui:{\r\n\t\tlabel:'span'\r\n\t},\r\n\tgetState(){\r\n\t\tlet val = this.getControlValue({ transform: toBool });\r\n\t\tif (val == null) {\r\n\t\t\tval = false;\r\n\t\t}\r\n\t\treturn 'is-' + val.toString();\r\n\t},\r\n\tclickSelector: '',\r\n\t_initClickHandler(){\r\n\t\tlet event = ('click ' + this.getOption('clickSelector')).trim();\r\n\t\tthis.delegateEvents({\r\n\t\t\t[event]:'clickHandler'\r\n\t\t});\r\n\t},\r\n\tclickHandler(event){\r\n\t\tevent.stopPropagation();\r\n\t\tlet val = this.getControlValue();\r\n\t\tthis.setControlValue(!val);\r\n\t},\r\n\trefreshStateLabel(){\r\n\t\tif (!this.model) {\r\n\t\t\tthis.refreshCssClass();\r\n\t\t}\r\n\r\n\t\tlet labels = this.getOption('labels');\r\n\t\tif(!_.isObject(labels)){\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tlet val = this.getControlValue() === true;\r\n\t\tlet label = labels[val];\r\n\t\tif (isEmptyValue(label)) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tthis.ui.label.html(label);\r\n\r\n\t},\r\n\tprepareValueBeforeSet(value){\r\n\t\treturn toBool(value);\r\n\t}\r\n});\r\n"],"names":["Base","View","extend","options","apply","arguments","mergeOptions","html","icon","getOption","push","forceText","getText","_","template","join","events","e","stop","stopPropagation","preventDefault","before","beforeClick","then","triggerClick","data","triggerError","error","result","triggerMethod","isFunction","Promise","resolve","event","name","$el","prop","buttonMixin","getTriggerMethod","context","trigger","ensureError","value","Error","length","_initControl","once","validate","catch","valueOptions","_isDestroing","parent","getParentControl","_removeChildControl","children","getChildrenControls","each","child","_removeParentControl","_cntrl","control","off","index","indexOf","splice","controlName","getControlName","found","find","isObject","_controlInitialized","takeFirst","_clone","initControlValue","initParentControl","_onControlDestroy","setParentControl","_addChildControl","initial","notValidated","current","getControlValue","isValid","compareObjects","key","undefined","clone","valueKey","getByPath","transform","call","_prepareValueBeforeSet","isSameControlValue","_setControlValue","prepareValueBeforeSet","skipValidation","_onSetControlValueValidateSuccess","_validate","_onSetControlValueValidateFail","previous","isDone","_tryTriggerEvent","promise","_catch","_validatePromise","_onControlValidateSuccess","_onControlValidateFail","skipChildValidate","isControlWrapper","_isControlWrapper","reject","childrenErrors","childrenPromise","_validateChildrenControlsPromise","size","wrapped","_validateControlPromise","force","values","getParentControlValue","validateResult","errors","reduce","finaly","makeValid","noSet","silent","makeInvalid","betterResult","checkAlso","args","hasParentControl","childEvent","cce","def","defaultChildControlEvents","_debouncedChildControlEvents","dcce","defHandler","handler","handlerArguments","handlerName","delay","isNumber","debounce","handlerResult","isControlWraper","propagateParanet","cnt","_getEventContext","setControlValue","setPromise","controlDone","isArray","slice","namedEvent","handleChildControlEvent","parentTrigger","ControlMixin","CollectionView","isClass","Mixed","ControlViewMixin","CssClassModifiersMixin","cssClassModifiersMixin","CustomsMixin","customsMixin","_setControlValidInvalidListeners","addCssClassModifier","_controlValidInvalidListeners","on","_onControlValid","_onControlInvalid","makeControlReady","customs","getControlView","_customs","injectSystemViews","view","_setupChildControl","setupCustom","setupChildControl","noop","unshift","getHeaderView","getErrorView","getFooterView","_errorView","buildErrorView","buildViewByKey","buildHeaderView","tagName","_buildNestedTextView","TextView","buildText","text","opts","buildButtonsView","buildFooterView","_buttonsView","stopListening","buildButtonsOptions","settleButtonsListeners","Infinity","btns","hash","b","item","buildButton","isString","className","fixButton","button","buttonsView","_fulfill","listenTo","type","rest","parentControl","disableButtons","_showValidateError","enableButtons","_hideValidateError","disableButton","enableButton","shouldShow","skipFirstValidationError","_firstValidationErrorSkipped","show","showError","hide","hideError","_buttons","addPromiseBarCssClass","addButtons","buttons","buildButtons","pop","preventRender","addChildView","names","getButtonOptions","Button","buttonView","btn","defs","disable","enable","promiseBarMixin","textView","ControlView","controlViewMixin","PromiseBar","schema","model","Schema","getSchemaClass","createSchema","_schema","_createSchema","m","v","errorMessage","trim","render","mix","with","common","PropertySchema","getSchema","rule","getType","getValidation","getDefaultValidateRule","_getHeaderView","label","getLabel","getSchemaOptions","editOptions","getEdit","buildPropertyView","allValues","getValidateRule","validator","ModelSchema","EditProperty","getPropertiesViews","modelSchema","propertiesToShow","getPropertiesNames","map","_createEditProperty","getProperty","create","getEditPropertyClass","getPropertyValue","shouldShowError","errorView","getEditPropertyOptions","createEditProperty","property","defaultOptions","controls","guesControl","arg","getControlByName","sourceValues","getControlBySchema","modelType","noRange","getControl","default","defineControl","Control","BaseEditProperty","editPropertyMixin","getEditControl","getEditControlOptions","EditModel","editModelMixin","_getOption","getInputType","inputView","valueType","isDate","_valueIsNumber","inputType","fixAttributes","attrs","setInputAttributes","attributes","check","restrictionKeys","restrictions","key2","newattributes","ifNull","isChar","ctrlKey","eventContext","prevent","isEnteredCharValid","keyCode","shouldDone","originalEvent","clipboardData","getData","isValueValid","input","select","target","newvalue","toString","handleInputEvent","eventName","el","method","camelCase","setInputEvents","passedEvents","eventsArray","eventHandlers","keys","Memo","Mixin","buildRestrictions","pickNumbers","pickStrings","pickBools","pick","toLowerCase","convert","returnNullAndEmptyAs","returnOtherAs","len","getMaxLength","substring","num","isNaN","min","max","getValueType","maxlength","char","parseInt","parseFloat","required","minLength","strValue","pattern","RegExp","test","InputControl","inputMixin","TextArea","inputEvents","TextAreaControl","_delegateInputEvents","delegatedHandlers","selector","isSelected","get","id","_addSelectCssModifiers","triggerSelect","SelectableViewMixin","mixin","BaseSelectControl","initSelectorMixin","SelectControl","isMultiple","collection","getCollection","DefaultChildView","selectorOptions","_getSelectorOptions","Selector","getValue","source","getSource","extractValue","ind","toBool","split","filter","setSourceFilter","multiple","convertString","val","src","getState","_initClickHandler","refreshStateLabel","delegateEvents","refreshCssClass","labels","isEmptyValue","ui"],"mappings":"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"}